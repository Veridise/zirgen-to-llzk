<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zklang: lib/Passes/ConvertZhlToZml/Patterns.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<!-- doxygen-awesome extensions -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-fragment-copy-button.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph-link.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
    DoxygenAwesomeFragmentCopyButton.init()
    DoxygenAwesomeParagraphLink.init()
    DoxygenAwesomeInteractiveToc.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Zklang<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">Veridise&#39;s Zirgen frontend for LLZK</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_passes_2_convert_zhl_to_zml_2_patterns_8cpp_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Patterns.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">//===- Patterns.cpp - ZHL-&gt;ZML conversion patterns --------------*- C++ -*-===//</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">//</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Part of the LLZK Project, under the Apache License v2.0.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">// See LICENSE.txt for license information.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// Copyright 2025 Veridise Inc.</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// SPDX-License-Identifier: Apache-2.0</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;cassert&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;cstdint&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &lt;cstdio&gt;</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;llvm/ADT/SmallVectorExtras.h&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;llvm/Support/Casting.h&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &lt;llvm/Support/CommandLine.h&gt;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;mlir/Dialect/Func/IR/FuncOps.h&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;mlir/Dialect/Index/IR/IndexAttrs.h&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;mlir/Dialect/Index/IR/IndexOps.h&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &lt;mlir/Dialect/SCF/IR/SCF.h&gt;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;mlir/IR/Builders.h&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &lt;mlir/IR/BuiltinAttributes.h&gt;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;mlir/IR/BuiltinOps.h&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;mlir/IR/Diagnostics.h&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;mlir/IR/Location.h&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;mlir/IR/Region.h&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;mlir/IR/ValueRange.h&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;mlir/Support/LLVM.h&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;mlir/Support/LogicalResult.h&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;mlir/Transforms/DialectConversion.h&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;<a class="code" href="_array_frame_8h.html">zklang/Dialect/ZHL/Typing/ArrayFrame.h</a>&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;<a class="code" href="_component_slot_8h.html">zklang/Dialect/ZHL/Typing/ComponentSlot.h</a>&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;<a class="code" href="_frame_8h.html">zklang/Dialect/ZHL/Typing/Frame.h</a>&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &lt;<a class="code" href="_inner_frame_8h.html">zklang/Dialect/ZHL/Typing/InnerFrame.h</a>&gt;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;<a class="code" href="_params_storage_8h.html">zklang/Dialect/ZHL/Typing/ParamsStorage.h</a>&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;<a class="code" href="_type_binding_8h.html">zklang/Dialect/ZHL/Typing/TypeBinding.h</a>&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;<a class="code" href="_type_bindings_8h.html">zklang/Dialect/ZHL/Typing/TypeBindings.h</a>&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#include &lt;<a class="code" href="_builder_8h.html">zklang/Dialect/ZML/IR/Builder.h</a>&gt;</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="preprocessor">#include &lt;<a class="code" href="_op_interfaces_8h.html">zklang/Dialect/ZML/IR/OpInterfaces.h</a>&gt;</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#include &lt;<a class="code" href="_ops_8h.html">zklang/Dialect/ZML/IR/Ops.h</a>&gt;</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &lt;<a class="code" href="_types_8h.html">zklang/Dialect/ZML/IR/Types.h</a>&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &lt;<a class="code" href="_materialize_8h.html">zklang/Dialect/ZML/Typing/Materialize.h</a>&gt;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#include &lt;<a class="code" href="_z_m_l_type_converter_8h.html">zklang/Dialect/ZML/Typing/ZMLTypeConverter.h</a>&gt;</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#include &lt;<a class="code" href="_helpers_8h.html">zklang/Dialect/ZML/Utils/Helpers.h</a>&gt;</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;<a class="code" href="_passes_2_convert_zhl_to_zml_2_patterns_8h.html">zklang/Passes/ConvertZhlToZml/Patterns.h</a>&gt;</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span> </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   50</a></span><span class="preprocessor">#define DEBUG_TYPE &quot;lower-zhl-pass&quot;</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="keyword">using namespace </span>zirgen;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacezhl.html">zhl</a>;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacemlir.html">mlir</a>;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacezml.html">zml</a>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a927965acbb7ffdc959cf4ba317d8064e">validArgCount</a>(<span class="keywordtype">bool</span> isVariadic, <span class="keywordtype">size_t</span> argCount, <span class="keywordtype">size_t</span> formalsCount) {</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  <span class="keywordflow">if</span> (isVariadic) {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="comment">// For variadics it&#39;s only valid to have from formalsCount-1 arguments and onwards.</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordflow">return</span> argCount &gt;= formalsCount - 1;</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  }</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  <span class="comment">// For non variadics the number of arguments must be equal to the number of formals</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  <span class="keywordflow">return</span> argCount == formalsCount;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>}</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="keyword">inline</span> <span class="keywordtype">bool</span> isVariadic(mlir::ArrayRef&lt;mlir::Type&gt; ctorFormals) {</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  <span class="keywordflow">return</span> !ctorFormals.empty() &amp;&amp; mlir::isa&lt;VarArgsType&gt;(ctorFormals.back());</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>}</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="keyword">inline</span> <span class="keywordtype">bool</span> isVariadic(mlir::FunctionType fnType) { <span class="keywordflow">return</span> isVariadic(fnType.getInputs()); }</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>mlir::ValueRange::iterator</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a3cdf357a56d2f5f9a306cfaf20b51d81">computeVarArgsSplice</a>(mlir::ValueRange &amp;args, mlir::ArrayRef&lt;mlir::Type&gt; constructorTypes) {</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  <span class="keywordflow">if</span> (!isVariadic(constructorTypes)) {</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    <span class="keywordflow">return</span> args.end();</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  }</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <span class="comment">// If the call does not have any varargs then there are less elements in `args` than there is in</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <span class="comment">// `constructorTypes`. This comparison is safe because the call has already been type checked by</span></div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  <span class="comment">// this point.</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  <span class="keywordflow">if</span> (args.size() &lt; constructorTypes.size()) {</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keywordflow">return</span> args.end();</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  }</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  <span class="comment">// Compute how many arguments are var-args and substract that amount to the number of arguments to</span></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  <span class="comment">// get the offset from args.begin() where the var-args start.</span></div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keywordtype">size_t</span> C = constructorTypes.size();</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  assert(C &gt; 0);</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  assert(C &lt;= std::numeric_limits&lt;ptrdiff_t&gt;::max());</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  <span class="keywordflow">return</span> std::next(args.begin(), <span class="keyword">static_cast&lt;</span>ptrdiff_t<span class="keyword">&gt;</span>(C) - 1);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>}</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Op&gt;</div>
<div class="foldopen" id="foldopen00098" data-start="{" data-end="}">
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#ac9bdf8852d4fc16a7346c7a6a9d1a6c6">   98</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classzml_1_1_constructor_lowering.html#ac9bdf8852d4fc16a7346c7a6a9d1a6c6">ConstructorLowering&lt;Op&gt;::prepareArguments</a>(</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    mlir::ValueRange args, mlir::ArrayRef&lt;mlir::Type&gt; constructorTypes, mlir::Location loc,</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    mlir::ConversionPatternRewriter &amp;rewriter, std::vector&lt;mlir::Value&gt; &amp;preparedArgs</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  preparedArgs.clear();</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  preparedArgs.reserve(constructorTypes.size());</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="comment">// Compute the point where the normal arguments end and the var-args begin</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <span class="keyword">auto</span> argsEnd = <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a3cdf357a56d2f5f9a306cfaf20b51d81">computeVarArgsSplice</a>(args, constructorTypes);</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  <span class="comment">// Prepare the arguments up to the splice point. These arguments are passed as is since they are</span></div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <span class="comment">// normal arguments.</span></div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  std::transform(</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      args.begin(), argsEnd, constructorTypes.begin(), std::back_inserter(preparedArgs),</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>      [&amp;](mlir::Value v, mlir::Type t) { return prepareArgument(v, t, loc, rewriter); }</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  );</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  <span class="keywordflow">if</span> (isVariadic(constructorTypes)) {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    std::vector&lt;mlir::Value&gt; vargs;</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keyword">auto</span> varType = mlir::dyn_cast&lt;VarArgsType&gt;(constructorTypes.back());</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    assert(varType &amp;&amp; <span class="stringliteral">&quot;expecting a var args type&quot;</span>);</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span> </div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="comment">// If there aren&#39;t any arguments left to prepare then argsEnd == args.end() and this call is a</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">// no-op.</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    std::transform(argsEnd, args.end(), std::back_inserter(vargs), [&amp;](mlir::Value v) {</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      return prepareArgument(v, varType.getInner(), loc, rewriter);</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    });</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    <span class="comment">// Regardless of what std::transform does above add the VarArgsOp to make sure we have the</span></div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="comment">// correct number of arguments.</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keyword">auto</span> va = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_var_args_op.html">VarArgsOp</a>&gt;(loc, constructorTypes.back(), vargs);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    preparedArgs.push_back(va);</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span> </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>  assert(preparedArgs.size() == constructorTypes.size() &amp;&amp; <span class="stringliteral">&quot;incorrect number of arguments&quot;</span>);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>}</div>
</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span> </div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Op&gt;</div>
<div class="foldopen" id="foldopen00135" data-start="{" data-end="}">
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a3ac9d909f498bfdab8c49a6229305762">  135</a></span>mlir::Value <a class="code hl_function" href="classzml_1_1_constructor_lowering.html#a3ac9d909f498bfdab8c49a6229305762">ConstructorLowering&lt;Op&gt;::prepareArgument</a>(</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    mlir::Value arg, mlir::Type expectedType, mlir::Location loc,</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>  <span class="keywordflow">if</span> (arg.getType() == expectedType) {</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordflow">return</span> arg;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  }</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  <span class="comment">// If the input arg is an UnrealizedConversionCastOp and the expected type is a superclass of the</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  <span class="comment">// cast&#39;s input type, then generate a SuperCoerceOp directly on the input arg of the cast.</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> argCast = mlir::dyn_cast&lt;UnrealizedConversionCastOp&gt;(arg.getDefiningOp())) {</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    Operation::operand_range castInputs = argCast.getInputs();</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordflow">if</span> (castInputs.size() == 1) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      Value singleInput = castInputs[0];</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      <span class="keywordflow">if</span> (<span class="keyword">auto</span> inpCompType = mlir::dyn_cast&lt;ComponentType&gt;(singleInput.getType())) {</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        <span class="keywordflow">if</span> (inpCompType.subtypeOf(expectedType)) {</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>          <span class="keywordflow">return</span> rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_super_coerce_op.html">SuperCoerceOp</a>&gt;(loc, expectedType, singleInput);</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>        }</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    }</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  }</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  <span class="keyword">auto</span> binding = this-&gt;<a class="code hl_function" href="namespacezml.html#ab754e6906cb92a1b96b2813c7014813c">getType</a>(arg);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  Type type = mlir::succeeded(binding) ? <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(rewriter.getContext(), *binding)</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                                       : expectedType;</div>
<div class="foldopen" id="foldopen00160" data-start="{" data-end="}">
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#ac9bdf8852d4fc16a7346c7a6a9d1a6c6">  160</a></span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="keyword">auto</span> cast = rewriter.create&lt;UnrealizedConversionCastOp&gt;(loc, type, arg);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  Value castResult = cast.getResult(0);</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <span class="keywordflow">if</span> (castResult.getType() == expectedType) {</div>
<div class="foldopen" id="foldopen00164" data-start="{" data-end="}">
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a3ac9d909f498bfdab8c49a6229305762">  164</a></span>    <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  }</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  <span class="keywordflow">if</span> (mlir::isa&lt;zml::TypeVarType&gt;(type)) {</div>
<div class="foldopen" id="foldopen00167" data-start="{" data-end="}">
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a12e08e5b2270152c09bc4ce01a6a3332">  167</a></span>    <span class="keywordflow">return</span> rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_unifiable_cast_op.html">zml::UnifiableCastOp</a>&gt;(loc, expectedType, castResult);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  }</div>
<div class="foldopen" id="foldopen00169" data-start="{" data-end="}">
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a5b91cc3f0249ccc1293e5f8f8f078e79">  169</a></span>  <span class="keywordflow">return</span> rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_super_coerce_op.html">SuperCoerceOp</a>&gt;(loc, expectedType, castResult);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>}</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Op&gt;</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>FailureOr&lt;CtorCallBuilder&gt;</div>
<div class="foldopen" id="foldopen00174" data-start="{" data-end="}">
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a12e08e5b2270152c09bc4ce01a6a3332">  174</a></span><a class="code hl_function" href="classzml_1_1_constructor_lowering.html#a12e08e5b2270152c09bc4ce01a6a3332">ConstructorLowering&lt;Op&gt;::makeCtorCallBuilder</a>(Operation *op, Value value, OpBuilder &amp;builder)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <span class="keyword">auto</span> selfOp = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;();</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>  <span class="keywordflow">if</span> (!selfOp) {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;is not within a self region&quot;</span>;</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  }</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <span class="keywordflow">return</span> <a class="code hl_function" href="classzml_1_1_ctor_call_builder.html#a4b782252f7287479e94cd5e8314945c5">CtorCallBuilder::Make</a>(</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>      op, value, *this-&gt;<a class="code hl_variable" href="classzml_1_1_zhl_op_lowering_pattern.html#ad4a3b22232374806ab988275dd0a355b">typeAnalysis</a>, builder, selfOp.getSelfValue(), this-&gt;getTypeBindings()</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>  );</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>}</div>
</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Op&gt;</div>
<div class="foldopen" id="foldopen00185" data-start="{" data-end="}">
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="classzml_1_1_constructor_lowering.html#a5b91cc3f0249ccc1293e5f8f8f078e79">  185</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_constructor_lowering.html#a5b91cc3f0249ccc1293e5f8f8f078e79">ConstructorLowering&lt;Op&gt;::makeCtorCall</a>(</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    Op op, Value value, ValueRange newArgs, ConversionPatternRewriter &amp;rewriter,</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <a class="code hl_typedef" href="classzml_1_1_global_builder.html#abb4f7d196b103cc649ce5ba1bcf02a08">GlobalBuilder::AndName</a> globalBuilder</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  FailureOr&lt;CtorCallBuilder&gt; ctor = <a class="code hl_function" href="classzml_1_1_constructor_lowering.html#a12e08e5b2270152c09bc4ce01a6a3332">makeCtorCallBuilder</a>(op, value, rewriter);</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="keywordflow">if</span> (failed(ctor)) {</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <span class="keywordflow">return</span> failure(); <span class="comment">// makeCtorCallBuilder emits an error message already</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="keyword">const</span> <a class="code hl_class" href="classzhl_1_1_type_binding.html">TypeBinding</a> &amp;binding = ctor-&gt;getBinding();</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  FunctionType constructorType = ctor-&gt;getCtorType();</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  assert(constructorType &amp;&amp; <span class="stringliteral">&quot;Could not deduce the constructor type for component&quot;</span>);</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>  <span class="keyword">auto</span> ctorFormalsCount = constructorType.getInputs().size();</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span> </div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a927965acbb7ffdc959cf4ba317d8064e">validArgCount</a>(isVariadic(constructorType), newArgs.size(), ctorFormalsCount)) {</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    <span class="comment">// Depending if it&#39;s variadic or not the message changes a bit.</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    StringRef expectingNArgsMsg =</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>        isVariadic(constructorType) ? <span class="stringliteral">&quot;, was expecting at least &quot;</span> : <span class="stringliteral">&quot;, was expecting &quot;</span>;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <span class="keyword">auto</span> minArgCount = isVariadic(constructorType) ? ctorFormalsCount - 1 : ctorFormalsCount;</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <span class="keywordflow">return</span> op-&gt;emitOpError().append(</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        <span class="stringliteral">&quot;incorrect number of arguments for component &quot;</span>, binding.<a class="code hl_function" href="classzhl_1_1_type_binding.html#a39c29134b4ce739f507542a6535de81b">getName</a>(), expectingNArgsMsg,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>        minArgCount, <span class="stringliteral">&quot; arguments but got &quot;</span>, newArgs.size()</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    );</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  std::vector&lt;Value&gt; preparedArguments;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  <a class="code hl_function" href="classzml_1_1_constructor_lowering.html#ac9bdf8852d4fc16a7346c7a6a9d1a6c6">prepareArguments</a>(newArgs, constructorType.getInputs(), op-&gt;getLoc(), rewriter, preparedArguments);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  Value result = ctor-&gt;build(rewriter, op-&gt;getLoc(), preparedArguments, globalBuilder);</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <span class="keywordflow">if</span> (globalBuilder) {</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="comment">// In this case, cannot replace the old op uses with &#39;result&#39; because the old op has 0 results.</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    assert(op-&gt;getNumResults() == 0);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    rewriter.eraseOp(op);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    rewriter.replaceOp(op, result);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  }</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>}</div>
</div>
</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="keyword">template</span> <span class="keyword">class </span><a class="code hl_class" href="classzml_1_1_constructor_lowering.html">zml::ConstructorLowering&lt;zirgen::Zhl::ConstructOp&gt;</a>;</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="keyword">template</span> <span class="keyword">class </span><a class="code hl_class" href="classzml_1_1_constructor_lowering.html">zml::ConstructorLowering&lt;zirgen::Zhl::ConstructGlobalOp&gt;</a>;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span> </div>
<div class="foldopen" id="foldopen00229" data-start="{" data-end="}">
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_literal_lowering.html#a3e147e2bcb3a8f4f2422ff3f72786cae">  229</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_literal_lowering.html#a3e147e2bcb3a8f4f2422ff3f72786cae">ZhlLiteralLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    Zhl::LiteralOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="keyword">auto</span> val = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_lit_val_op.html">LitValOp</a>&gt;(op, val, adaptor.getValue());</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>}</div>
</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span> </div>
<div class="foldopen" id="foldopen00246" data-start="{" data-end="}">
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_literal_str_lowering.html#a2041197557ae96ad5ac5a42198ea724a">  246</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_literal_str_lowering.html#a2041197557ae96ad5ac5a42198ea724a">ZhlLiteralStrLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    Zhl::StringOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  }</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  <span class="keyword">auto</span> val = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_lit_str_op.html">LitStrOp</a>&gt;(op, val, adaptor.getValue());</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>}</div>
</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="foldopen" id="foldopen00262" data-start="{" data-end="}">
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_parameter_lowering.html#a81f4a43d268e2a7c7cca7a33e72b955e">  262</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_parameter_lowering.html#a81f4a43d268e2a7c7cca7a33e72b955e">ZhlParameterLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    Zhl::ConstructorParamOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>  <span class="keyword">auto</span> body = op-&gt;getParentOfType&lt;mlir::func::FuncOp&gt;();</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  mlir::BlockArgument arg = body.getArgument(adaptor.getIndex());</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_nop_op.html">NopOp</a>&gt;(op, arg.getType(), arg);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>}</div>
</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="foldopen" id="foldopen00276" data-start="{" data-end="}">
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a927965acbb7ffdc959cf4ba317d8064e">  276</a></span><span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a927965acbb7ffdc959cf4ba317d8064e">validArgCount</a>(<span class="keywordtype">bool</span> isVariadic, <span class="keywordtype">size_t</span> argCount, <span class="keywordtype">size_t</span> formalsCount) {</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <span class="keywordflow">if</span> (isVariadic) {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// For variadics it&#39;s only valid to have from formalsCount-1 arguments and onwards.</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="keywordflow">return</span> argCount &gt;= formalsCount - 1;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="comment">// For non variadics the number of arguments must be equal to the number of formals</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  <span class="keywordflow">return</span> argCount == formalsCount;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>}</div>
</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span> </div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>mlir::ValueRange::iterator</div>
<div class="foldopen" id="foldopen00286" data-start="{" data-end="}">
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a3cdf357a56d2f5f9a306cfaf20b51d81">  286</a></span><a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a3cdf357a56d2f5f9a306cfaf20b51d81">computeVarArgsSplice</a>(mlir::ValueRange &amp;args, mlir::ArrayRef&lt;mlir::Type&gt; constructorTypes) {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>  <span class="keywordflow">if</span> (!isVariadic(constructorTypes)) {</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <span class="keywordflow">return</span> args.end();</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  }</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>  <span class="comment">// If the call does not have any varargs then there are less elements in `args` than there is in</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  <span class="comment">// `constructorTypes`. This comparison is safe because the call has already been type checked by</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  <span class="comment">// this point.</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  <span class="keywordflow">if</span> (args.size() &lt; constructorTypes.size()) {</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <span class="keywordflow">return</span> args.end();</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>  }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <span class="comment">// Compute how many arguments are var-args and substract that amount to the number of arguments to</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <span class="comment">// get the offset from args.begin() where the var-args start.</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <span class="keywordtype">size_t</span> C = constructorTypes.size();</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  assert(C &gt; 0);</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  assert(C &lt;= std::numeric_limits&lt;ptrdiff_t&gt;::max());</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  <span class="keywordflow">return</span> std::next(args.begin(), <span class="keyword">static_cast&lt;</span>ptrdiff_t<span class="keyword">&gt;</span>(C) - 1);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>}</div>
</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="foldopen" id="foldopen00306" data-start="{" data-end="}">
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_constrain_lowering.html#a8854ff472353d4c4ae2aa9b9980a25f7">  306</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_constrain_lowering.html#a8854ff472353d4c4ae2aa9b9980a25f7">ZhlConstrainLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    Zhl::ConstraintOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  <span class="keywordflow">if</span> (failed(binding)) {</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  }</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <span class="keyword">auto</span> lhsBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getLhs());</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <span class="keywordflow">if</span> (mlir::failed(lhsBinding)) {</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check lhs&quot;</span>;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="keyword">auto</span> rhsBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getRhs());</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keywordflow">if</span> (mlir::failed(rhsBinding)) {</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check rhs&quot;</span>;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <span class="keyword">auto</span> constraintType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  mlir::Value lhsValue = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getLhs(), *lhsBinding, rewriter, constraintType);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  mlir::Value rhsValue = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getRhs(), *rhsBinding, rewriter, constraintType);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_constrain_op.html">ConstrainOp</a>&gt;(op, lhsValue, rhsValue);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>}</div>
</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span></div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span> </div>
<div class="foldopen" id="foldopen00335" data-start="{" data-end="}">
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_global_removal.html#a0336adfaa93b8534b0617b9f9e451044">  335</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_global_removal.html#a0336adfaa93b8534b0617b9f9e451044">ZhlGlobalRemoval::matchAndRewrite</a>(</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    zirgen::Zhl::GlobalOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_nop_op.html">NopOp</a>&gt;(</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>      op, mlir::TypeRange({<a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding)}), mlir::ValueRange()</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  );</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>}</div>
</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="foldopen" id="foldopen00348" data-start="{" data-end="}">
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_directive_removal.html#a5f8683fc81efdac6910ea25d8b245ffe">  348</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_directive_removal.html#a5f8683fc81efdac6910ea25d8b245ffe">ZhlDirectiveRemoval::matchAndRewrite</a>(</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    zirgen::Zhl::DirectiveOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  rewriter.eraseOp(op);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>}</div>
</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="foldopen" id="foldopen00359" data-start="{" data-end="}">
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_generic_removal.html#a3f620c84dcc91faf4892778f01d05a11">  359</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_generic_removal.html#a3f620c84dcc91faf4892778f01d05a11">ZhlGenericRemoval::matchAndRewrite</a>(</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    zirgen::Zhl::TypeParamOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  }</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  <span class="keyword">auto</span> type = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  <span class="keywordflow">if</span> (binding-&gt;isGenericParam() &amp;&amp; binding-&gt;getSuperType().isVal()) {</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_load_val_param_op.html">LoadValParamOp</a>&gt;(</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        op, <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext()), op.getNameAttr()</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>    );</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_nop_op.html">NopOp</a>&gt;(op, mlir::TypeRange({type}), mlir::ValueRange());</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  }</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>}</div>
</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="foldopen" id="foldopen00381" data-start="{" data-end="}">
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_specialize_removal.html#abc6c0894af054aa2c42783c34469d2f2">  381</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_specialize_removal.html#abc6c0894af054aa2c42783c34469d2f2">ZhlSpecializeRemoval::matchAndRewrite</a>(</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>    zirgen::Zhl::SpecializeOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_nop_op.html">NopOp</a>&gt;(</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      op, mlir::TypeRange({<a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding)}), mlir::ValueRange()</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  );</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>}</div>
</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span></div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="foldopen" id="foldopen00398" data-start="{" data-end="}">
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_declaration_removal.html#a0a3a4ab658621b46e9f53607d0ee6287">  398</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_declaration_removal.html#a0a3a4ab658621b46e9f53607d0ee6287">ZhlDeclarationRemoval::matchAndRewrite</a>(</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    zirgen::Zhl::DeclarationOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_nop_op.html">NopOp</a>&gt;(</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>      op, mlir::TypeRange({<a class="code hl_function" href="classzml_1_1_component_type.html#ab7655cf701af8d634089ddea1a601a00">ComponentType::Component</a>(rewriter.getContext())}), mlir::ValueRange()</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  );</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>}</div>
</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span></div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="foldopen" id="foldopen00411" data-start="{" data-end="}">
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_define_lowering.html#a5e5c2c0891a6d8104a511beade835c6f">  411</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_define_lowering.html#a5e5c2c0891a6d8104a511beade835c6f">ZhlDefineLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    zirgen::Zhl::DefinitionOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>  }</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  <span class="keyword">auto</span> declrBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getDeclaration());</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>  <span class="keywordflow">if</span> (failed(declrBinding)) {</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check declaration expression&quot;</span>;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  }</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>  <span class="keyword">auto</span> exprBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getDefinition());</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>  <span class="keywordflow">if</span> (failed(exprBinding)) {</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check definition expression&quot;</span>;</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>  }</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>  <a class="code hl_class" href="classzhl_1_1_component_slot.html">ComponentSlot</a> *slot = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>  <span class="keywordflow">if</span> (binding-&gt;getSlot()) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *thisSlot = dyn_cast&lt;ComponentSlot&gt;(binding-&gt;getSlot())) {</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>      slot = thisSlot;</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    }</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (declrBinding-&gt;getSlot()) {</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <span class="keywordflow">if</span> (<span class="keyword">auto</span> *declrSlot = dyn_cast&lt;ComponentSlot&gt;(declrBinding-&gt;getSlot())) {</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>      slot = declrSlot;</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    }</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>  }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  <span class="keyword">auto</span> comp = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_component_interface.html">ComponentInterface</a>&gt;();</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>  assert(comp);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>  <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;().getSelfValue();</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>  mlir::Value value = adaptor.getDefinition();</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span> </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>  <span class="comment">// If the binding of this op has a slot then it is responsible of creating it.</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <span class="comment">// Otherwise, check if the declaration&#39;s binding has a slot. If it does create it here.</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <span class="comment">// Wrap the value around a SuperCoerceOp.</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>  <span class="comment">// If a slot is created here that means that the value we are storing in the field does not need</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  <span class="comment">// memory according to the type checker and thus we don&#39;t need to introduce the use-def cut since</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>  <span class="comment">// that value is safe to use in @constrain functions.</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span> </div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>  <span class="keywordflow">if</span> (slot) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keyword">auto</span> slotName = <a class="code hl_function" href="namespacezml.html#af59c2deb15e027bf93c75fdb6172d390">createSlot</a>(slot, rewriter, comp, op.getLoc());</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    mlir::Type slotType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), slot-&gt;getBinding());</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    SmallVector&lt;Operation *, 2&gt; castOps;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    Value result = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(value, *exprBinding, rewriter, castOps);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <a class="code hl_function" href="namespacezml.html#ac909911d5ab140af73258b71963d2328">storeSlot</a>(*slot, result, slotName, slotType, op.getLoc(), rewriter, self);</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>  }</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>  rewriter.eraseOp(op);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>}</div>
</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span> </div>
<div class="foldopen" id="foldopen00466" data-start="{" data-end="}">
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_super_lowering_in_func.html#a9781968a1e31743df8627f82824be112">  466</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_super_lowering_in_func.html#a9781968a1e31743df8627f82824be112">ZhlSuperLoweringInFunc::matchAndRewrite</a>(</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    zirgen::Zhl::SuperOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  }</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <span class="keywordflow">if</span> (!mlir::isa&lt;SelfOp&gt;(op-&gt;getParentOp())) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  }</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  <span class="keyword">auto</span> comp = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_component_interface.html">ComponentInterface</a>&gt;();</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>  assert(comp);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;().getSelfValue();</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  mlir::Type target = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>  <span class="keyword">auto</span> value = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getValue(), rewriter, target);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordflow">if</span> (mlir::failed(value)) {</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  }</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_write_field_op.html">WriteFieldOp</a>&gt;(op, self, <span class="stringliteral">&quot;$super&quot;</span>, *value);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>}</div>
</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="foldopen" id="foldopen00493" data-start="{" data-end="}">
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a9ffdcaf5a638cbbd35ae33479857a4c2">  493</a></span>std::vector&lt;mlir::NamedAttribute&gt; <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a9ffdcaf5a638cbbd35ae33479857a4c2">externFuncAttrs</a>(mlir::ConversionPatternRewriter &amp;rewriter) {</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  <span class="keywordflow">return</span> {</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>      mlir::NamedAttribute(rewriter.getStringAttr(<span class="stringliteral">&quot;extern&quot;</span>), rewriter.getUnitAttr()),</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>      mlir::NamedAttribute(</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>          rewriter.getStringAttr(<span class="stringliteral">&quot;sym_visibility&quot;</span>), rewriter.getStringAttr(<span class="stringliteral">&quot;private&quot;</span>)</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>      )</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>  };</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>}</div>
</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="foldopen" id="foldopen00502" data-start="{" data-end="}">
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a85c493b761c1cf532126eeebf8ac6ab6">  502</a></span>mlir::FailureOr&lt;mlir::func::FuncOp&gt; <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a85c493b761c1cf532126eeebf8ac6ab6">createExternFunc</a>(</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_class" href="classzml_1_1_component_interface.html">ComponentInterface</a> op, Twine &amp;name, mlir::FunctionType type,</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    mlir::ConversionPatternRewriter &amp;rewriter, mlir::Location loc</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>) {</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  mlir::OpBuilder::InsertionGuard guard(rewriter);</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  rewriter.setInsertionPointAfter(op);</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keyword">auto</span> attrs = <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a9ffdcaf5a638cbbd35ae33479857a4c2">externFuncAttrs</a>(rewriter);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  SmallVector&lt;char, 10&gt; nameMem;</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  <span class="keywordflow">return</span> rewriter.create&lt;mlir::func::FuncOp&gt;(loc, name.toStringRef(nameMem), type, attrs);</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>}</div>
</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span> </div>
<div class="foldopen" id="foldopen00513" data-start="{" data-end="}">
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_extern_lowering.html#a0160889e694c94557f96e42f94b21a2a">  513</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_extern_lowering.html#a0160889e694c94557f96e42f94b21a2a">ZhlExternLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    Zhl::ExternOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  }</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <span class="keyword">auto</span> comp = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_component_op.html">ComponentOp</a>&gt;();</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <span class="keywordflow">if</span> (!comp) {</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  }</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>  std::vector&lt;mlir::Type&gt; argBindings;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> arg : op.getArgs()) {</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="keyword">auto</span> argBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(arg);</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>    <span class="keywordflow">if</span> (mlir::failed(argBinding)) {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>      <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check argument #&quot;</span> &lt;&lt; argBindings.size();</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>    }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>    argBindings.push_back(<a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *argBinding));</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="keyword">auto</span> retType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span> </div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  <span class="comment">// Extern ops are wrapped around a component by the AST-&gt;ZHL step and have the same inputs as the</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>  <span class="comment">// component.</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  <span class="keyword">auto</span> funcType =</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>      rewriter.getFunctionType(comp.getBodyFunc().getFunctionType().getInputs(), {retType});</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>  Twine externName = op.getName() + <span class="stringliteral">&quot;$$extern&quot;</span>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>  <span class="keyword">auto</span> externDeclrResult = <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a85c493b761c1cf532126eeebf8ac6ab6">createExternFunc</a>(comp, externName, funcType, rewriter, op.getLoc());</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>  <span class="keywordflow">if</span> (failed(externDeclrResult)) {</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  }</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>  <span class="keyword">auto</span> externNameSymRef = SymbolRefAttr::get(rewriter.getStringAttr(externName));</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span> </div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  <span class="keyword">auto</span> externFnRef = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_extern_fn_ref_op.html">ExternFnRefOp</a>&gt;(op.getLoc(), funcType, externNameSymRef);</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>  std::vector&lt;mlir::Value&gt; args;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  std::transform(</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>      adaptor.getArgs().begin(), adaptor.getArgs().end(), argBindings.begin(),</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>      std::back_inserter(args),</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>      [&amp;](mlir::Value adaptorValue, mlir::Type argType) {</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    if (adaptorValue.getType() == argType) {</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>      return adaptorValue;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    }</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <span class="keyword">auto</span> cast =</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        rewriter.create&lt;mlir::UnrealizedConversionCastOp&gt;(op.getLoc(), argType, adaptorValue);</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <span class="keywordflow">return</span> cast.getResult(0);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>  }</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  );</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  rewriter.replaceOpWithNewOp&lt;mlir::func::CallIndirectOp&gt;(op, externFnRef, mlir::ValueRange(args));</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>}</div>
</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span> </div>
<div class="foldopen" id="foldopen00572" data-start="{" data-end="}">
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_lookup_lowering.html#af0abe1b1620e7cbb122b2dc31b581ad2">  572</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_lookup_lowering.html#af0abe1b1620e7cbb122b2dc31b581ad2">ZhlLookupLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    Zhl::LookupOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="keyword">auto</span> comp = adaptor.getComponent();</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>  LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;comp value: &quot;</span> &lt;&lt; comp &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>  <span class="keyword">auto</span> originalComp = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getComponent());</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>  <span class="keywordflow">if</span> (mlir::failed(originalComp)) {</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check component reference&quot;</span>;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;type binding for the component: &quot;</span> &lt;&lt; *originalComp &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>             llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;Full printout: \n&quot;</span>; originalComp-&gt;print(llvm::dbgs(), <span class="keyword">true</span>);</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>             llvm::dbgs() &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  <span class="keyword">auto</span> materializedType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *originalComp);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;     which materializes to &quot;</span> &lt;&lt; materializedType &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  <span class="keyword">auto</span> compType = mlir::dyn_cast&lt;ComponentType&gt;(materializedType);</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="keywordflow">if</span> (!compType) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;type mismatch, cannot access a member for a non-component type &quot;</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>                           &lt;&lt; materializedType;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>  }</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  <span class="keywordflow">if</span> (comp.getType() != compType) {</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;Casting &quot;</span> &lt;&lt; comp.getType() &lt;&lt; <span class="stringliteral">&quot; to &quot;</span> &lt;&lt; compType &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keyword">auto</span> cast = rewriter.create&lt;mlir::UnrealizedConversionCastOp&gt;(op.getLoc(), compType, comp);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    comp = cast.getResult(0);</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>  }</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  mlir::SymbolTableCollection st;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="keyword">auto</span> mod = op-&gt;getParentOfType&lt;mlir::ModuleOp&gt;();</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="keyword">auto</span> compDef = compType.getDefinition(st, mod);</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  assert(compDef &amp;&amp; <span class="stringliteral">&quot;Component type without a definition!&quot;</span>);</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span> </div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>  LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;Component&#39;s code:\n&quot;</span> &lt;&lt; compDef &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span> </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  LLVM_DEBUG(</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>      llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;Starting search for member &quot;</span> &lt;&lt; adaptor.getMember() &lt;&lt; <span class="stringliteral">&quot; starting with type &quot;</span></div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                   &lt;&lt; compType &lt;&lt; <span class="charliteral">&#39;\n&#39;</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  );</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="keyword">auto</span> nameSym = mlir::SymbolRefAttr::get(adaptor.getMemberAttr());</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  <span class="keywordflow">while</span> (mlir::failed(compDef.lookupFieldType(nameSym))) {</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;  Failed! Trying with the super type\n&quot;</span>);</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <span class="keyword">auto</span> superType = compType.getSuperType();</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="keywordflow">if</span> (!superType) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>      LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;  Failed to get the super type\n&quot;</span>);</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>      <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;member &quot;</span> &lt;&lt; adaptor.getMember() &lt;&lt; <span class="stringliteral">&quot; was not found&quot;</span>;</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    }</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    compType = mlir::dyn_cast&lt;ComponentType&gt;(superType);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <span class="keywordflow">if</span> (!compType) {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>      LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;  Super type is not a component\n&quot;</span>);</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>      <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;type mismatch, cannot access a member for a non-component type &quot;</span></div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>                             &lt;&lt; superType;</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    }</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span> </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    compDef = compType.getDefinition(st, mod);</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    LLVM_DEBUG(llvm::dbgs() &lt;&lt; <span class="stringliteral">&quot;Trying again with super type &quot;</span> &lt;&lt; compType &lt;&lt; <span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  }</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>  <span class="keyword">auto</span> field = originalComp-&gt;getMember(nameSym.getValue(), [&amp;op] { return op-&gt;emitError(); });</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  assert(succeeded(field));</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  <span class="keyword">auto</span> fieldType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *field);</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>  assert(fieldType);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span> </div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  }</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="keyword">auto</span> bindingType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  <span class="keywordflow">if</span> (fieldType != bindingType) {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;type mismatch, was expecting &quot;</span> &lt;&lt; bindingType &lt;&lt; <span class="stringliteral">&quot; but field &quot;</span></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>                           &lt;&lt; adaptor.getMember() &lt;&lt; <span class="stringliteral">&quot; is of type &quot;</span> &lt;&lt; fieldType;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  }</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="comment">// Coerce to the type in the chain that defines the accessed member</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  comp = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_super_coerce_op.html">SuperCoerceOp</a>&gt;(op.getLoc(), compType, comp);</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span> </div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_read_field_op.html">ReadFieldOp</a>&gt;(op, bindingType, comp, adaptor.getMember());</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>}</div>
</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span> </div>
<div class="foldopen" id="foldopen00652" data-start="{" data-end="}">
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_subscript_lowering.html#a37eaa532c3b8baff7607542ef559c616">  652</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_subscript_lowering.html#a37eaa532c3b8baff7607542ef559c616">ZhlSubscriptLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    Zhl::SubscriptOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  <span class="keyword">auto</span> arrayBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getArray());</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="keywordflow">if</span> (mlir::failed(arrayBinding)) {</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check array reference&quot;</span>;</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  }</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <span class="keyword">auto</span> elementBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getElement());</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  <span class="keywordflow">if</span> (mlir::failed(elementBinding)) {</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check index&quot;</span>;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  }</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <span class="keyword">auto</span> concreteArrayTypeBinding = arrayBinding-&gt;getConcreteArrayType();</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <span class="keywordflow">if</span> (failed(concreteArrayTypeBinding)) {</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  }</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>  Type concreteArrayType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">zml::materializeTypeBinding</a>(getContext(), *concreteArrayTypeBinding);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  <span class="keyword">auto</span> arrayVal = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getArray(), *arrayBinding, rewriter, concreteArrayType);</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <span class="keyword">auto</span> Val = <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext());</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>  <span class="keyword">auto</span> elementVal = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getElement(), *elementBinding, rewriter, Val);</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_read_array_op.html">zml::ReadArrayOp</a>&gt;(</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      op, <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">zml::materializeTypeBinding</a>(getContext(), *binding), arrayVal, elementVal</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>  );</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>}</div>
</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span> </div>
<div class="foldopen" id="foldopen00689" data-start="{" data-end="}">
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_array_lowering.html#a427797a08fa5acf2479f181e31f66ae9">  689</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_array_lowering.html#a427797a08fa5acf2479f181e31f66ae9">ZhlArrayLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>    Zhl::ArrayOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  }</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span> </div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>  <span class="keywordflow">if</span> (!binding-&gt;isArray()) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;was expecting an &#39;Array&#39; component but got &#39;&quot;</span> &lt;&lt; binding-&gt;getName()</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>                             &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  }</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>  <span class="keyword">auto</span> arrayType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>  <span class="keyword">auto</span> elementTypeBinding = binding-&gt;getArrayElement([&amp;]() { <span class="keywordflow">return</span> op-&gt;emitOpError(); });</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>  <span class="keywordflow">if</span> (mlir::failed(elementTypeBinding)) {</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>  }</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>  <span class="keyword">auto</span> elementType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *elementTypeBinding);</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span> </div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>  <span class="keywordflow">if</span> (adaptor.getElements().empty()) {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;cannot be an empty array literal&quot;</span>;</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>  }</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  llvm::SmallVector&lt;FailureOr&lt;TypeBinding&gt;, 1&gt; argBindings =</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>      llvm::map_to_vector(op.getElements(), [<span class="keyword">this</span>](<span class="keyword">auto</span> element) { return getType(element); });</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>  <span class="keywordflow">if</span> (llvm::any_of(argBindings, failed)) {</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check array values&quot;</span>;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>  }</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>  llvm::SmallVector&lt;mlir::Value&gt; args;</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span> </div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>  std::transform(</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      adaptor.getElements().begin(), adaptor.getElements().end(), argBindings.begin(),</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      std::back_inserter(args),</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      [&amp;](<span class="keyword">auto</span> element, <span class="keyword">auto</span> eltBinding) -&gt; Value {</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    return getCastedValue(element, *eltBinding, rewriter, elementType);</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>  }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  );</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_new_array_op.html">NewArrayOp</a>&gt;(op, arrayType, args);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>}</div>
</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span></div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span> </div>
<div class="foldopen" id="foldopen00735" data-start="{" data-end="}">
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_comp_to_zmir_comp_pattern.html#a1e561bf99880d9aafac856dca72be4ce">  735</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_comp_to_zmir_comp_pattern.html#a1e561bf99880d9aafac856dca72be4ce">ZhlCompToZmirCompPattern::matchAndRewrite</a>(</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    zirgen::Zhl::ComponentOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  <span class="keyword">auto</span> name = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getName());</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>  <span class="keywordflow">if</span> (mlir::failed(name)) {</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;could not be lowered because its type could not be infered&quot;</span>;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  <a class="code hl_class" href="classzml_1_1_component_builder.html">ComponentBuilder</a> builder;</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>  <span class="keyword">auto</span> genericNames = name-&gt;getGenericParamNames();</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  <span class="keyword">auto</span> paramLocations = name-&gt;getConstructorParamLocations();</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <span class="keyword">auto</span> ctorType = <a class="code hl_function" href="namespacezml.html#a3bae9dacc6b7b762216f2f107a48bdb7">materializeTypeBindingConstructor</a>(rewriter, *name, <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a49a09b8c68b8526db04e3cd4845163cb">getTypeBindings</a>());</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  builder.<a class="code hl_function" href="classzml_1_1_component_builder.html#a60fba3b494f1b54ceb6064ba59d27654">name</a>(name-&gt;getName())</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>      .<a class="code hl_function" href="classzml_1_1_component_builder.html#a826b89436fc7a0f473177fcd53439096">location</a>(op-&gt;getLoc())</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>      .<a class="code hl_function" href="classzml_1_1_component_builder.html#ac0d83ffa84f702bc30166621484d2a1e">attrs</a>(op-&gt;getAttrs())</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>      .<a class="code hl_function" href="classzml_1_1_component_builder.html#a9f7a15c8cb8421c02a70b9c3cc476939">typeParams</a>(genericNames)</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>      .<a class="code hl_function" href="classzml_1_1_component_builder.html#a8c45f614967cc4c2378d9722f7aa2fc2">constructor</a>(ctorType, paramLocations)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>      .<a class="code hl_function" href="classzml_1_1_component_builder.html#a4bc5d93d94402a7987286ded0879570e">takeRegion</a>(&amp;op.getRegion());</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;[fieldName, binding] : name-&gt;getMembers()) {</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <span class="keywordflow">if</span> (!binding.has_value()) {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>      <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check component member &#39;&quot;</span> &lt;&lt; fieldName &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    }</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>  }</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keyword">auto</span> &amp;super = name-&gt;getSuperType();</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>  builder.<a class="code hl_function" href="classzml_1_1_component_builder.html#a9fb3bcad8b4c9785b19950daa19e7207">field</a>(<span class="stringliteral">&quot;$super&quot;</span>, <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), super));</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  <span class="keyword">auto</span> maybeBuiltin = mlir::SymbolTable::lookupSymbolIn(</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>      op-&gt;getParentOfType&lt;mlir::ModuleOp&gt;().getOperation(), op.getName()</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>  );</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span> </div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>  <span class="keywordflow">if</span> (maybeBuiltin) {</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    rewriter.eraseOp(maybeBuiltin);</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    builtinOverriden(op.getName());</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>  }</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>  <span class="keyword">auto</span> comp = builder.<a class="code hl_function" href="classzml_1_1_component_builder.html#a020c538361200cd26f7aef43b8c75fec">build</a>(rewriter);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span> </div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>  rewriter.replaceOp(op.getOperation(), comp.getOperation());</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span> </div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>}</div>
</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span></div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="foldopen" id="foldopen00780" data-start="{" data-end="}">
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_range_op_lowering.html#a7818eb7b9b67048477205792276c2dd6">  780</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_range_op_lowering.html#a7818eb7b9b67048477205792276c2dd6">ZhlRangeOpLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    Zhl::RangeOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>  }</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>  assert(binding-&gt;isArray());</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>  <span class="keyword">auto</span> startBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getStart());</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>  <span class="keywordflow">if</span> (mlir::failed(startBinding)) {</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check start&quot;</span>;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  }</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>  <span class="keyword">auto</span> endBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getEnd());</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>  <span class="keywordflow">if</span> (mlir::failed(endBinding)) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check end&quot;</span>;</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>  }</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>  <span class="keyword">auto</span> type = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>  <span class="keyword">auto</span> innerBinding = binding-&gt;getArrayElement([&amp;]() { <span class="keywordflow">return</span> op-&gt;emitError(); });</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>  <span class="keywordflow">if</span> (mlir::failed(innerBinding)) {</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>  }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>  <span class="comment">// Create a literal array directly if we know the range is made of literal values</span></div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>  <span class="keywordflow">if</span> (startBinding-&gt;isKnownConst() &amp;&amp; endBinding-&gt;isKnownConst()) {</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    SmallVector&lt;int64_t&gt; values;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    uint64_t E = endBinding-&gt;getConst();</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    uint64_t I = startBinding-&gt;getConst();</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>    values.reserve(E - I);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>    <span class="keywordflow">for</span> (; I &lt; E; I++) {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>      assert(I &lt;= std::numeric_limits&lt;int64_t&gt;::max());</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>      values.push_back(<span class="keyword">static_cast&lt;</span>int64_t<span class="keyword">&gt;</span>(I));</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>    }</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>    DenseI64ArrayAttr litArr = rewriter.getDenseI64ArrayAttr(values);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>    rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_lit_val_array_op.html">LitValArrayOp</a>&gt;(</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>        op, <a class="code hl_function" href="classzml_1_1_component_type.html#a02d908bf206f77032892b4767092e5ca">ComponentType::Array</a>(getContext(), <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext()), values.size()),</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>        litArr</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    );</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>    <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>  }</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  <span class="keyword">auto</span> innerType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *innerBinding);</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>  Value startVal =</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>      <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getStart(), *startBinding, rewriter, <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext()));</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>  Value endVal =</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>      <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getEnd(), *endBinding, rewriter, <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext()));</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>  <span class="keyword">auto</span> arrAlloc = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_alloc_array_op.html">AllocArrayOp</a>&gt;(op.getLoc(), type);</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>  <span class="comment">// Create a for loop op using the operands as bounds</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>  <span class="keyword">auto</span> one = rewriter.create&lt;arith::ConstantIndexOp&gt;(op.getLoc(), 1);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>  <span class="keyword">auto</span> start = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_val_to_index_op.html">ValToIndexOp</a>&gt;(op.getStart().getLoc(), startVal);</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>  <span class="keyword">auto</span> end = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_val_to_index_op.html">ValToIndexOp</a>&gt;(op.getEnd().getLoc(), endVal);</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>  <span class="keyword">auto</span> loop = rewriter.create&lt;mlir::scf::ForOp&gt;(</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>      op.getLoc(), start, end, one, <span class="comment">/*mlir::ValueRange()*/</span> ValueRange({arrAlloc}),</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>      [&amp;](mlir::OpBuilder &amp;builder, mlir::Location loc, mlir::Value iv, mlir::ValueRange args) {</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>    <span class="keyword">auto</span> conv = builder.create&lt;<a class="code hl_class" href="classzml_1_1_index_to_val_op.html">IndexToValOp</a>&gt;(loc, innerType, iv);</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    builder.create&lt;<a class="code hl_class" href="classzml_1_1_write_array_op.html">WriteArrayOp</a>&gt;(loc, args[0], iv, conv);</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    builder.create&lt;scf::YieldOp&gt;(loc, args[0]);</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>  }</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>  );</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>  rewriter.replaceOp(op, <span class="comment">/*arrAlloc*/</span> loop);</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span> </div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>}</div>
</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span></div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span> </div>
<div class="foldopen" id="foldopen00849" data-start="{" data-end="}">
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_map_lowering.html#a4bced19fe3b8f5e2e2479eeb6185cf5e">  849</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_map_lowering.html#a4bced19fe3b8f5e2e2479eeb6185cf5e">ZhlMapLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    Zhl::MapOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>  }</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>  <span class="keywordflow">if</span> (!binding-&gt;isArray()) {</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;was expecting &#39;Array&#39; but got &#39;&quot;</span> &lt;&lt; binding-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>  }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>  assert(binding-&gt;getSlot());</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>  <span class="keyword">auto</span> *arrayFrame = cast&lt;ArrayFrame&gt;(binding-&gt;getSlot());</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span> </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>  <span class="keyword">auto</span> inputBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getArray());</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>  <span class="keywordflow">if</span> (mlir::failed(inputBinding)) {</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check input&quot;</span>;</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>  }</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>  <span class="keywordflow">if</span> (!inputBinding-&gt;isArray()) {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;was expecting &#39;Array&#39; but got &#39;&quot;</span> &lt;&lt; inputBinding-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>  }</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>  <span class="keyword">auto</span> innerInputBinding = inputBinding-&gt;getArrayElement([&amp;]() { <span class="keywordflow">return</span> op-&gt;emitError(); });</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>  <span class="keywordflow">if</span> (mlir::failed(innerInputBinding)) {</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>  }</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span> </div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>  Type itType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *innerInputBinding);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>  Type outputType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span> </div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>  <span class="keyword">auto</span> arrValue = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getArray(), rewriter);</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  assert(succeeded(arrValue) &amp;&amp; <span class="stringliteral">&quot;this binding was validated above&quot;</span>);</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>  <span class="keyword">auto</span> concreteArrValue =</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>      <a class="code hl_function" href="namespacezml.html#ac77c76297c90961806f887bcec9d1992">coerceToArray</a>(mlir::dyn_cast&lt;TypedValue&lt;ComponentType&gt;&gt;(*arrValue), rewriter);</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>  assert(succeeded(concreteArrValue));</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span> </div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>  <span class="keyword">auto</span> arrAlloc = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_alloc_array_op.html">AllocArrayOp</a>&gt;(op.getLoc(), outputType);</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>  <span class="keyword">auto</span> one = rewriter.create&lt;arith::ConstantIndexOp&gt;(op.getLoc(), 1);</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>  <span class="keyword">auto</span> zero = rewriter.create&lt;arith::ConstantIndexOp&gt;(op.getLoc(), 0);</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  <span class="keyword">auto</span> len = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_get_array_len_op.html">GetArrayLenOp</a>&gt;(op.getLoc(), *concreteArrValue);</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  <span class="keyword">auto</span> loop = rewriter.create&lt;mlir::scf::ForOp&gt;(</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>      op.getLoc(), zero, len-&gt;getResult(0), one, mlir::ValueRange(arrAlloc),</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>      [&amp;](mlir::OpBuilder &amp;builder, mlir::Location loc, mlir::Value iv, mlir::ValueRange) {</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    arrayFrame-&gt;setInductionVar(iv);</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    auto itVal = builder.create&lt;ReadArrayOp&gt;(loc, itType, *concreteArrValue, mlir::ValueRange(iv));</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    <span class="comment">// Cast it to a zhl Expr type for the block inlining</span></div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    auto itValCast = builder.create&lt;mlir::UnrealizedConversionCastOp&gt;(</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>        loc, mlir::TypeRange(Zhl::ExprType::get(getContext())), mlir::ValueRange(itVal)</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>    );</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    auto loopPrologue = builder.getInsertionBlock();</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span> </div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    rewriter.inlineBlockBefore(</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>        &amp;op.getRegion().front(), loopPrologue, loopPrologue-&gt;end(),</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        mlir::ValueRange(itValCast.getResult(0))</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>    );</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>  }</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>  );</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>  <span class="keywordflow">if</span> (<span class="keyword">auto</span> compSlot = dyn_cast_if_present&lt;ComponentSlot&gt;(binding-&gt;getSlot())) {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>    <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;().getSelfValue();</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    <a class="code hl_class" href="classzml_1_1_component_interface.html">ComponentInterface</a> comp = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_component_interface.html">ComponentInterface</a>&gt;();</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>    assert(comp);</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>    <span class="keyword">auto</span> name = <a class="code hl_function" href="namespacezml.html#af59c2deb15e027bf93c75fdb6172d390">createSlot</a>(compSlot, rewriter, comp, op.getLoc());</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>    <span class="keyword">auto</span> slotType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), compSlot-&gt;getBinding());</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <span class="keyword">auto</span> val = <a class="code hl_function" href="namespacezml.html#acd1fe036d69906f5ce404618887ba966">storeAndLoadSlot</a>(*compSlot, arrAlloc, name, slotType, op.getLoc(), rewriter, self);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>    rewriter.replaceOp(op, val);</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>    rewriter.replaceOp(op, arrAlloc);</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>  }</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>  loop-&gt;setAttr(<span class="stringliteral">&quot;original_op&quot;</span>, rewriter.getStringAttr(<span class="stringliteral">&quot;map&quot;</span>));</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>}</div>
</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="foldopen" id="foldopen00921" data-start="{" data-end="}">
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_block_lowering.html#a01b2f5186fce126e3c79327a9afa66a2">  921</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_block_lowering.html#a01b2f5186fce126e3c79327a9afa66a2">ZhlBlockLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>    Zhl::BlockOp op, OpAdaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>  }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span> </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>  <span class="keyword">auto</span> type = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span> </div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>  <span class="keyword">auto</span> exec = rewriter.create&lt;mlir::scf::ExecuteRegionOp&gt;(op.getLoc(), type);</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>  rewriter.inlineRegionBefore(op.getRegion(), exec.getRegion(), exec.getRegion().end());</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>  rewriter.replaceOp(op, exec);</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>}</div>
</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span> </div>
<div class="foldopen" id="foldopen00937" data-start="{" data-end="}">
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_super_lowering_in_map.html#a94e3406aafb86cdee66528c7b9f35310">  937</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_super_lowering_in_map.html#a94e3406aafb86cdee66528c7b9f35310">ZhlSuperLoweringInMap::matchAndRewrite</a>(</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>    Zhl::SuperOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>  <span class="keyword">auto</span> parent = op-&gt;getParentOp();</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>  <span class="keywordflow">if</span> (!parent || !mlir::isa&lt;mlir::scf::ForOp&gt;(parent)) {</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>  }</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>  <span class="keyword">auto</span> loopOp = mlir::cast&lt;mlir::scf::ForOp&gt;(parent);</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>  <span class="keyword">auto</span> loopOriginalOp = loopOp-&gt;getAttr(<span class="stringliteral">&quot;original_op&quot;</span>);</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>  <span class="keywordflow">if</span> (!loopOriginalOp || loopOriginalOp != rewriter.getStringAttr(<span class="stringliteral">&quot;map&quot;</span>)) {</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>  }</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>  <span class="keyword">auto</span> value = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getValue(), rewriter);</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>  <span class="keywordflow">if</span> (failed(value)) {</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check super value&quot;</span>;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>  }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>  <span class="keyword">auto</span> iv = loopOp.getInductionVar();</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>  <span class="keyword">auto</span> arr = loopOp.getRegionIterArgs().front();</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>  rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_write_array_op.html">WriteArrayOp</a>&gt;(op.getLoc(), arr, iv, *value);</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>  rewriter.replaceOpWithNewOp&lt;mlir::scf::YieldOp&gt;(op, loopOp.getRegionIterArgs());</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>}</div>
</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span> </div>
<div class="foldopen" id="foldopen00964" data-start="{" data-end="}">
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_super_lowering_in_block.html#a3596751eebc43993717960d7971e0b4b">  964</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_super_lowering_in_block.html#a3596751eebc43993717960d7971e0b4b">ZhlSuperLoweringInBlock::matchAndRewrite</a>(</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    Zhl::SuperOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>  <span class="keyword">auto</span> parent = op-&gt;getParentOp();</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>  <span class="keywordflow">if</span> (!parent || !mlir::isa&lt;mlir::scf::ExecuteRegionOp&gt;(parent)) {</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>  }</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>  }</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>  <span class="keyword">auto</span> valueBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getValue());</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>  <span class="keywordflow">if</span> (failed(valueBinding)) {</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check value&quot;</span>;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>  }</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span> </div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>  Value yieldValue;</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>  <span class="keywordflow">if</span> (binding-&gt;hasClosure()) {</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>    <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;().getSelfValue();</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    assert(self);</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    <span class="keyword">auto</span> pod = <a class="code hl_function" href="namespacezml.html#ab50cb91affe3de64b07a2bbd6c18e45e">constructPODComponent</a>(op, *binding, rewriter, self, [&amp;]() -&gt; Value {</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>      <span class="keywordflow">return</span> <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>          adaptor.getValue(), *valueBinding, rewriter,</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>          <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), binding-&gt;getSuperType())</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>      );</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    }, <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a49a09b8c68b8526db04e3cd4845163cb">getTypeBindings</a>());</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <span class="keywordflow">if</span> (failed(pod)) {</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>      <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    }</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    yieldValue = *pod;</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    yieldValue = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>        adaptor.getValue(), *valueBinding, rewriter, <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding)</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>    );</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>    ;</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  }</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span> </div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>  rewriter.replaceOpWithNewOp&lt;mlir::scf::YieldOp&gt;(op, yieldValue);</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>}</div>
</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span> </div>
<div class="foldopen" id="foldopen01005" data-start="{" data-end="}">
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_super_lowering_in_switch.html#a2bd9b972eeefd01e2195af932048955d"> 1005</a></span>mlir::LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_super_lowering_in_switch.html#a2bd9b972eeefd01e2195af932048955d">ZhlSuperLoweringInSwitch::matchAndRewrite</a>(</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    Zhl::SuperOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  <span class="keyword">auto</span> parent = op-&gt;getParentOp();</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  <span class="keywordflow">if</span> (!parent || !mlir::isa&lt;mlir::scf::IfOp&gt;(parent)) {</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>  }</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>  <span class="keywordflow">if</span> (mlir::failed(binding)) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>  }</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span> </div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>  <span class="keyword">auto</span> type = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>  assert(parent-&gt;getResultTypes().size() == 1);</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>  <span class="keyword">auto</span> parentType = parent-&gt;getResultTypes().front();</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>  <span class="keyword">auto</span> value = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getValue(), rewriter, type);</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>  <span class="keywordflow">if</span> (failed(value)) {</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>  }</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>  <span class="keyword">auto</span> coercion = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_super_coerce_op.html">SuperCoerceOp</a>&gt;(op.getLoc(), parentType, *value);</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span> </div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>  rewriter.replaceOpWithNewOp&lt;mlir::scf::YieldOp&gt;(op, coercion.getResult());</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>}</div>
</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span> </div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">static</span> T &amp;slot(<span class="keyword">const</span> <a class="code hl_class" href="classzhl_1_1_type_binding.html">TypeBinding</a> &amp;b) {</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>  <span class="keywordflow">return</span> *mlir::cast_if_present&lt;T&gt;(b.<a class="code hl_function" href="classzhl_1_1_type_binding.html#a20c511f4ffa7a629ee39f76ed416f19b">getSlot</a>());</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>}</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">static</span> T &amp;slot(<span class="keyword">const</span> FailureOr&lt;TypeBinding&gt; &amp;b) {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>  <span class="keywordflow">return</span> *mlir::cast_if_present&lt;T&gt;(b-&gt;getSlot());</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>}</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span></div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span><span class="keyword">struct </span>Bindings {</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>  <span class="comment">// - op: The ReduceOp operation</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>  <span class="comment">// - input: The array expression that gets reduced</span></div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>  <span class="comment">// - inputInner: The inner type of `input`</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  <span class="comment">// - acc: The accumulator component&#39;s type</span></div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>  FailureOr&lt;TypeBinding&gt; op, input, inputInner, acc;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>};</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span> </div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span> </div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Pat, <span class="keyword">typename</span> Op&gt;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="keyword">static</span> LogicalResult validateReducePattern(<span class="keyword">const</span> Pat &amp;pat, Op op, Bindings &amp;bindings) {</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>  bindings.op = pat.getType(op);</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>  <span class="keywordflow">if</span> (mlir::failed(bindings.op)) {</div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>  }</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>  bindings.input = pat.getType(op.getArray());</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>  <span class="keywordflow">if</span> (mlir::failed(bindings.input)) {</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check input&quot;</span>;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  }</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>  <span class="keywordflow">if</span> (!bindings.input-&gt;isArray()) {</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;was expecting &#39;Array&#39; but got &#39;&quot;</span> &lt;&lt; bindings.input-&gt;getName() &lt;&lt; <span class="stringliteral">&quot;&#39;&quot;</span>;</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>  }</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>  bindings.inputInner = bindings.input-&gt;getArrayElement([&amp;] { <span class="keywordflow">return</span> op-&gt;emitError(); });</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>  <span class="keywordflow">if</span> (mlir::failed(bindings.inputInner)) {</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>  }</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>  bindings.acc = pat.getType(op.getType());</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>  <span class="keywordflow">if</span> (mlir::failed(bindings.acc)) {</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check accumulator&quot;</span>;</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>  }</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>}</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span><span class="keyword">static</span> LogicalResult validateConstructorType(</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    Operation *op, <span class="keyword">const</span> FailureOr&lt;TypeBinding&gt; &amp;accBinding, <span class="keyword">const</span> TypeBindings &amp;bindings,</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    FunctionType &amp;constructorType, OpBuilder &amp;builder</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>) {</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>  constructorType = <a class="code hl_function" href="namespacezml.html#a3bae9dacc6b7b762216f2f107a48bdb7">materializeTypeBindingConstructor</a>(builder, *accBinding, bindings);</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>  assert(constructorType);</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>  <span class="keywordflow">if</span> (constructorType.getInputs().size() != 2) {</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;was expecting a constructor with two arguments but got &quot;</span></div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>                             &lt;&lt; constructorType.getInputs().size() &lt;&lt; <span class="stringliteral">&quot; arguments&quot;</span>;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>  }</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>}</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span><span class="keyword">static</span> Value superCoerce(Value v, Type t, OpBuilder &amp;builder) {</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>  <span class="keywordflow">if</span> (v.getType() == t) {</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>    <span class="keywordflow">return</span> v;</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>  }</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>  <span class="keywordflow">return</span> builder.create&lt;<a class="code hl_class" href="classzml_1_1_super_coerce_op.html">SuperCoerceOp</a>&gt;(v.getLoc(), t, v);</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>};</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span> </div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span><span class="keyword">static</span> FailureOr&lt;CtorCallBuilder&gt; initializeCtorCallBuilder(</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    Operation *op, Bindings &amp;bindings, OpBuilder &amp;builder, <span class="keyword">const</span> TypeBindings &amp;typeBindings</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>) {</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>  <span class="comment">// Allocate a component slot for the output of the accumulator.</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>  <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;().getSelfValue();</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>  slot&lt;ArrayFrame&gt;(bindings.op).getFrame().allocateSlot&lt;ComponentSlot&gt;(typeBindings, *bindings.acc);</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span> </div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>  <span class="keyword">auto</span> ctorBuilder = <a class="code hl_function" href="classzml_1_1_ctor_call_builder.html#a4b782252f7287479e94cd5e8314945c5">CtorCallBuilder::Make</a>(op, *bindings.acc, builder, self, typeBindings);</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>  <span class="keywordflow">if</span> (mlir::failed(ctorBuilder)) {</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>    <span class="keywordflow">return</span> mlir::failure();</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>  }</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>  <span class="keywordflow">return</span> ctorBuilder;</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>}</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="keyword">namespace </span>{</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span> </div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span><span class="keyword">struct </span>LoopValues {</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>  Value init, array, stride, <a class="code hl_variable" href="_l_i_c_e_n_s_e_8txt.html#aaf8226a059307a1b18aac1295b5cf3a2">from</a>, to;</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>};</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span> </div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>} <span class="comment">// namespace</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span> </div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Pat, <span class="keyword">typename</span> Op, <span class="keyword">typename</span> Adaptor&gt;</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span><span class="keyword">static</span> LogicalResult prepareLoopValues(</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    <span class="keyword">const</span> Pat &amp;pat, Op op, Adaptor adaptor, LoopValues &amp;loopValues, OpBuilder &amp;builder,</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    Type outputType, Bindings &amp;bindings</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>) {</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span> </div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>  <span class="keyword">auto</span> initResult = pat.getCastedValue(adaptor.getInit(), builder, outputType);</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>  <span class="keywordflow">if</span> (failed(initResult)) {</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type cast init value&quot;</span>;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>  }</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  loopValues.init = *initResult;</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  <span class="keyword">auto</span> arrayResult = <a class="code hl_function" href="namespacezml.html#ac77c76297c90961806f887bcec9d1992">coerceToArray</a>(</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>      mlir::cast&lt;TypedValue&lt;ComponentType&gt;&gt;(</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>          pat.getCastedValue(adaptor.getArray(), *bindings.input, builder)</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>      ),</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>      builder</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  );</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>  <span class="comment">// If we cannot coerce to an array here either the IR is malformed or we are lacking checks in the</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  <span class="comment">// type analysis.</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  assert(succeeded(arrayResult));</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>  loopValues.array = *arrayResult;</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  loopValues.stride = builder.create&lt;arith::ConstantIndexOp&gt;(op.getLoc(), 1);</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>  loopValues.from = builder.create&lt;arith::ConstantIndexOp&gt;(op.getLoc(), 0);</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>  loopValues.to = builder.create&lt;<a class="code hl_class" href="classzml_1_1_get_array_len_op.html">GetArrayLenOp</a>&gt;(op.getLoc(), *arrayResult);</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span> </div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>}</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span> </div>
<div class="foldopen" id="foldopen01146" data-start="{" data-end="}">
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_reduce_lowering.html#aa1d25dc8251e9d8790bc501357288241"> 1146</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_reduce_lowering.html#aa1d25dc8251e9d8790bc501357288241">ZhlReduceLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>    Zhl::ReduceOp op, OpAdaptor adaptor, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  Bindings bindings;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  FunctionType constructorType;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span> </div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>  <span class="keywordflow">if</span> (failed(validateReducePattern(*<span class="keyword">this</span>, op, bindings)) ||</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>      failed(validateConstructorType(op, bindings.acc, <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a49a09b8c68b8526db04e3cd4845163cb">getTypeBindings</a>(), constructorType, rewriter)</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>      )) {</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>  }</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>  <span class="keyword">auto</span> ctorBuilder = initializeCtorCallBuilder(op, bindings, rewriter, <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a49a09b8c68b8526db04e3cd4845163cb">getTypeBindings</a>());</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>  <span class="keywordflow">if</span> (failed(ctorBuilder)) {</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>  }</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span> </div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>  <span class="keyword">auto</span> outputType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *bindings.op);</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span> </div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  LoopValues lv;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>  <span class="keywordflow">if</span> (failed(prepareLoopValues(*<span class="keyword">this</span>, op, adaptor, lv, rewriter, outputType, bindings))) {</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>    <span class="keywordflow">return</span> failure();</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>  }</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span> </div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>  <span class="keyword">auto</span> loop = rewriter.create&lt;mlir::scf::ForOp&gt;(</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>      op.getLoc(), lv.from, lv.to, lv.stride, mlir::ValueRange(lv.init),</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>      [&amp;](mlir::OpBuilder &amp;builder, mlir::Location loc, mlir::Value iv, mlir::ValueRange args) {</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    slot&lt;ArrayFrame&gt;(bindings.op).setInductionVar(iv);</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span> </div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>    auto itType = materializeTypeBinding(getContext(), *bindings.inputInner);</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    mlir::Value rhs = superCoerce(</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>        builder.create&lt;ReadArrayOp&gt;(loc, itType, lv.array, mlir::ValueRange(iv)),</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>        constructorType.getInput(1), builder</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>    );</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span> </div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    mlir::Value lhs = superCoerce(args[0], constructorType.getInput(0), builder);</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>    auto accResult = ctorBuilder-&gt;build(builder, adaptor.getType().getLoc(), {lhs, rhs});</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span> </div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    builder.create&lt;mlir::scf::YieldOp&gt;(loc, superCoerce(accResult, outputType, builder));</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>  }</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  );</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span> </div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>  rewriter.replaceOp(op, loop);</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>  loop-&gt;setAttr(<span class="stringliteral">&quot;original_op&quot;</span>, rewriter.getStringAttr(<span class="stringliteral">&quot;reduce&quot;</span>));</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span> </div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  <span class="keywordflow">return</span> mlir::success();</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>}</div>
</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span> </div>
<div class="foldopen" id="foldopen01194" data-start="{" data-end="}">
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af6481a736dda88081db77b69beb4352f"> 1194</a></span>Value <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af6481a736dda88081db77b69beb4352f">createNthCond</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> idx, Value selector, OpBuilder &amp;rewriter) {</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>  <span class="keyword">auto</span> val = <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(rewriter.getContext());</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <span class="comment">// Load the selector value from the array</span></div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>  <span class="keyword">auto</span> nth = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_lit_val_op.html">LitValOp</a>&gt;(selector.getLoc(), val, idx);</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  <span class="keyword">auto</span> item = rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_read_array_op.html">ReadArrayOp</a>&gt;(selector.getLoc(), val, selector, ValueRange(nth));</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>  <span class="comment">// Check if the value is equal to 1 (by converting it into a boolean)</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>  <span class="keywordflow">return</span> rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_val_to_i1_op.html">ValToI1Op</a>&gt;(selector.getLoc(), item);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>}</div>
</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span></div>
<div class="foldopen" id="foldopen01205" data-start="{" data-end="}">
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af02d08081fa532ab36c616e9cd9b53ef"> 1205</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af02d08081fa532ab36c616e9cd9b53ef">inlineRegion</a>(</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    Region *region, Block &amp;dest, Block::iterator it, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>) {</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>  assert(region-&gt;getBlocks().size() == 1);</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>  rewriter.inlineBlockBefore(&amp;region-&gt;front(), &amp;dest, it);</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>}</div>
</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span></div>
<div class="foldopen" id="foldopen01213" data-start="{" data-end="}">
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"><a class="line" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a4628db039f0e81ce18350c46c1cd456d"> 1213</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a4628db039f0e81ce18350c46c1cd456d">buildIfThenElseChain</a>(</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    RegionRange::iterator region_begin, RegionRange::iterator region_end,</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    ValueRange::iterator conds, Block &amp;dest, Block::iterator destIt,</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    ConversionPatternRewriter &amp;rewriter, Type retType</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>) {</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>  Value cond = *conds;</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>  OpBuilder::InsertionGuard guard(rewriter);</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>  rewriter.setInsertionPoint(&amp;dest, destIt);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>  <span class="keywordflow">if</span> (std::next(region_begin) == region_end) {</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    rewriter.create&lt;<a class="code hl_class" href="classzml_1_1_assert_op.html">AssertOp</a>&gt;(cond.getLoc(), cond);</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af02d08081fa532ab36c616e9cd9b53ef">inlineRegion</a>(*region_begin, dest, rewriter.getInsertionPoint(), rewriter);</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>  }</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>  <span class="keyword">auto</span> ifOp = rewriter.create&lt;scf::IfOp&gt;(cond.getLoc(), retType, cond, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>  <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af02d08081fa532ab36c616e9cd9b53ef">inlineRegion</a>(</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>      *region_begin, ifOp.getThenRegion().front(), ifOp.getThenRegion().front().end(), rewriter</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>  );</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>  <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a4628db039f0e81ce18350c46c1cd456d">buildIfThenElseChain</a>(</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>      std::next(region_begin), region_end, std::next(conds), ifOp.getElseRegion().front(),</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>      ifOp.getElseRegion().front().end(), rewriter, retType</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>  );</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>  rewriter.create&lt;scf::YieldOp&gt;(ifOp.getLoc(), ifOp.getResults());</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>}</div>
</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span> </div>
<div class="foldopen" id="foldopen01238" data-start="{" data-end="}">
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_switch_lowering.html#a2ba4008057e887df5016da6f6e8713c2"> 1238</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_switch_lowering.html#a2ba4008057e887df5016da6f6e8713c2">ZhlSwitchLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>    Zhl::SwitchOp op, OpAdaptor adaptor, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>  <span class="keywordflow">if</span> (failed(binding)) {</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>  }</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>  <span class="keyword">auto</span> arrType =</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      <a class="code hl_function" href="classzml_1_1_component_type.html#a02d908bf206f77032892b4767092e5ca">ComponentType::Array</a>(getContext(), <a class="code hl_function" href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">ComponentType::Val</a>(getContext()), op.getNumRegions());</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>  <span class="keyword">auto</span> selector = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">getCastedValue</a>(adaptor.getSelector(), rewriter, arrType);</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>  <span class="keywordflow">if</span> (failed(selector)) {</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check selector&quot;</span>;</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>  }</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>  SmallVector&lt;Value&gt; conds;</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>  conds.reserve(op.getNumRegions());</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n = 0; n &lt; op.getNumRegions(); n++) {</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    conds.push_back(<a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af6481a736dda88081db77b69beb4352f">createNthCond</a>(n, *selector, rewriter));</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>  }</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>  ValueRange condsRange(conds);</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span> </div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>  <span class="keyword">auto</span> retType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span> </div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>  <span class="keyword">auto</span> execRegion = rewriter.create&lt;scf::ExecuteRegionOp&gt;(op.getLoc(), retType);</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>  RegionRange regions = op.getRegions();</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>  Block &amp;block = execRegion.getRegion().emplaceBlock();</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>  <a class="code hl_function" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a4628db039f0e81ce18350c46c1cd456d">buildIfThenElseChain</a>(</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>      regions.begin(), regions.end(), condsRange.begin(), block, block.end(), rewriter, retType</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>  );</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>  rewriter.replaceOp(op, execRegion);</div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span> </div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>}</div>
</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span> </div>
<div class="foldopen" id="foldopen01271" data-start="{" data-end="}">
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_back_lowering.html#a2534c7cb90ee44d0dc0016a1d2a81e8c"> 1271</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_back_lowering.html#a2534c7cb90ee44d0dc0016a1d2a81e8c">ZhlBackLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>    Zhl::BackOp op, OpAdaptor, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>  <span class="keywordflow">if</span> (failed(binding)) {</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>  }</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span> </div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>  <span class="keyword">auto</span> trgBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getTarget());</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>  <span class="keywordflow">if</span> (failed(trgBinding)) {</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check target&quot;</span>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>  }</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>  assert(trgBinding-&gt;getSlot());</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span> </div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>  <span class="keyword">auto</span> distBinding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op.getDistance());</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>  <span class="keywordflow">if</span> (failed(distBinding)) {</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    <span class="keywordflow">return</span> op-&gt;emitError() &lt;&lt; <span class="stringliteral">&quot;failed to type check distance expression&quot;</span>;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>  }</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span> </div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>  <span class="keyword">auto</span> self = op-&gt;getParentOfType&lt;<a class="code hl_class" href="classzml_1_1_self_op.html">SelfOp</a>&gt;();</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>  assert(self);</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>  <span class="keyword">auto</span> *trgSlot = mlir::cast&lt;ComponentSlot&gt;(trgBinding-&gt;getSlot());</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>  <span class="keyword">auto</span> slotType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), trgSlot-&gt;getBinding());</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>  <span class="keyword">auto</span> dist = distBinding-&gt;getConstExpr()-&gt;convertIntoAttribute(rewriter);</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_read_back_op.html">ReadBackOp</a>&gt;(</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>      op, slotType, self.getSelfValue(), dist, trgSlot-&gt;getSlotName()</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>  );</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>}</div>
</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="foldopen" id="foldopen01303" data-start="{" data-end="}">
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_construct_global_lowering.html#a6bcf0ea7316a9faa47ea074347d93218"> 1303</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_construct_global_lowering.html#a6bcf0ea7316a9faa47ea074347d93218">ZhlConstructGlobalLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    zirgen::Zhl::ConstructGlobalOp op, OpAdaptor adaptor, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>  <span class="keywordflow">return</span> this-&gt;<a class="code hl_function" href="classzml_1_1_constructor_lowering.html#a5b91cc3f0249ccc1293e5f8f8f078e79">makeCtorCall</a>(</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>      op, op.getConstructType(), adaptor.getArgs(), rewriter, <a class="code hl_function" href="classzml_1_1_global_builder.html#af722e91ec191961b6712012fa219c4aa">forName</a>(op.getNameAttr())</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>  );</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>}</div>
</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span> </div>
<div class="foldopen" id="foldopen01311" data-start="{" data-end="}">
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"><a class="line" href="classzml_1_1_zhl_get_global_lowering.html#aca5dbb53afc791608db27b907e48c413"> 1311</a></span>LogicalResult <a class="code hl_function" href="classzml_1_1_zhl_get_global_lowering.html#aca5dbb53afc791608db27b907e48c413">ZhlGetGlobalLowering::matchAndRewrite</a>(</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    zirgen::Zhl::GetGlobalOp op, OpAdaptor, ConversionPatternRewriter &amp;rewriter</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>  <span class="keyword">auto</span> binding = <a class="code hl_function" href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">getType</a>(op);</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>  <span class="keywordflow">if</span> (failed(binding)) {</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>    <span class="keywordflow">return</span> op-&gt;emitOpError() &lt;&lt; <span class="stringliteral">&quot;failed to type check&quot;</span>;</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>  }</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>  Type retType = <a class="code hl_function" href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">materializeTypeBinding</a>(getContext(), *binding);</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  <a class="code hl_typedef" href="classzml_1_1_global_builder.html#abb4f7d196b103cc649ce5ba1bcf02a08">GlobalBuilder::AndName</a> globalBuilder = <a class="code hl_function" href="classzml_1_1_global_builder.html#af722e91ec191961b6712012fa219c4aa">forName</a>(op.getNameAttr());</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>  SymbolRefAttr globalName = <a class="code hl_function" href="classzml_1_1_global_builder.html#a56dc63c9a609448dfdd7a1236380e26a">buildDef</a>(globalBuilder, op.getLoc(), retType);</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>  rewriter.replaceOpWithNewOp&lt;<a class="code hl_class" href="classzml_1_1_get_global_op.html">GetGlobalOp</a>&gt;(op, retType, globalName);</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>  <span class="keywordflow">return</span> success();</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>}</div>
</div>
</div>
</div>
</div>
</div>
<div class="ttc" id="a_array_frame_8h_html"><div class="ttname"><a href="_array_frame_8h.html">ArrayFrame.h</a></div></div>
<div class="ttc" id="a_builder_8h_html"><div class="ttname"><a href="_builder_8h.html">Builder.h</a></div></div>
<div class="ttc" id="a_component_slot_8h_html"><div class="ttname"><a href="_component_slot_8h.html">ComponentSlot.h</a></div></div>
<div class="ttc" id="a_frame_8h_html"><div class="ttname"><a href="_frame_8h.html">Frame.h</a></div></div>
<div class="ttc" id="a_helpers_8h_html"><div class="ttname"><a href="_helpers_8h.html">Helpers.h</a></div></div>
<div class="ttc" id="a_inner_frame_8h_html"><div class="ttname"><a href="_inner_frame_8h.html">InnerFrame.h</a></div></div>
<div class="ttc" id="a_l_i_c_e_n_s_e_8txt_html_aaf8226a059307a1b18aac1295b5cf3a2"><div class="ttname"><a href="_l_i_c_e_n_s_e_8txt.html#aaf8226a059307a1b18aac1295b5cf3a2">from</a></div><div class="ttdeci">Apache License January AND DISTRIBUTION Definitions License shall mean the terms and conditions for and distribution as defined by Sections through of this document Licensor shall mean the copyright owner or entity authorized by the copyright owner that is granting the License Legal Entity shall mean the union of the acting entity and all other entities that control are controlled by or are under common control with that entity For the purposes of this definition control direct or to cause the direction or management of such whether by contract or including but not limited to software source documentation and configuration files Object form shall mean any form resulting from mechanical transformation or translation of a Source including but not limited to compiled object generated and conversions to other media types Work shall mean the work of whether in Source or Object made available under the as indicated by a copyright notice that is included in or attached to the whether in Source or Object that is based or other modifications as a an original work of authorship For the purposes of this Derivative Works shall not include works that remain separable from</div><div class="ttdef"><b>Definition</b> <a href="_l_i_c_e_n_s_e_8txt_source.html#l00046">LICENSE.txt:46</a></div></div>
<div class="ttc" id="a_materialize_8h_html"><div class="ttname"><a href="_materialize_8h.html">Materialize.h</a></div></div>
<div class="ttc" id="a_op_interfaces_8h_html"><div class="ttname"><a href="_op_interfaces_8h.html">OpInterfaces.h</a></div></div>
<div class="ttc" id="a_ops_8h_html"><div class="ttname"><a href="_ops_8h.html">Ops.h</a></div></div>
<div class="ttc" id="a_params_storage_8h_html"><div class="ttname"><a href="_params_storage_8h.html">ParamsStorage.h</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_a3cdf357a56d2f5f9a306cfaf20b51d81"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a3cdf357a56d2f5f9a306cfaf20b51d81">computeVarArgsSplice</a></div><div class="ttdeci">mlir::ValueRange::iterator computeVarArgsSplice(mlir::ValueRange &amp;args, mlir::ArrayRef&lt; mlir::Type &gt; constructorTypes)</div><div class="ttdef"><b>Definition</b> <a href="#l00286">Patterns.cpp:286</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_a4628db039f0e81ce18350c46c1cd456d"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a4628db039f0e81ce18350c46c1cd456d">buildIfThenElseChain</a></div><div class="ttdeci">void buildIfThenElseChain(RegionRange::iterator region_begin, RegionRange::iterator region_end, ValueRange::iterator conds, Block &amp;dest, Block::iterator destIt, ConversionPatternRewriter &amp;rewriter, Type retType)</div><div class="ttdoc">Builds an if-then-else chain with each region of the switch op.</div><div class="ttdef"><b>Definition</b> <a href="#l01213">Patterns.cpp:1213</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_a85c493b761c1cf532126eeebf8ac6ab6"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a85c493b761c1cf532126eeebf8ac6ab6">createExternFunc</a></div><div class="ttdeci">mlir::FailureOr&lt; mlir::func::FuncOp &gt; createExternFunc(ComponentInterface op, Twine &amp;name, mlir::FunctionType type, mlir::ConversionPatternRewriter &amp;rewriter, mlir::Location loc)</div><div class="ttdef"><b>Definition</b> <a href="#l00502">Patterns.cpp:502</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_a927965acbb7ffdc959cf4ba317d8064e"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a927965acbb7ffdc959cf4ba317d8064e">validArgCount</a></div><div class="ttdeci">bool validArgCount(bool isVariadic, size_t argCount, size_t formalsCount)</div><div class="ttdoc">ZhlConstrainLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00276">Patterns.cpp:276</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_a9ffdcaf5a638cbbd35ae33479857a4c2"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#a9ffdcaf5a638cbbd35ae33479857a4c2">externFuncAttrs</a></div><div class="ttdeci">std::vector&lt; mlir::NamedAttribute &gt; externFuncAttrs(mlir::ConversionPatternRewriter &amp;rewriter)</div><div class="ttdoc">ZhlExternLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00493">Patterns.cpp:493</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_af02d08081fa532ab36c616e9cd9b53ef"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af02d08081fa532ab36c616e9cd9b53ef">inlineRegion</a></div><div class="ttdeci">void inlineRegion(Region *region, Block &amp;dest, Block::iterator it, ConversionPatternRewriter &amp;rewriter)</div><div class="ttdoc">Inlines a switch arm region. The region must have only 1 block.</div><div class="ttdef"><b>Definition</b> <a href="#l01205">Patterns.cpp:1205</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8cpp_html_af6481a736dda88081db77b69beb4352f"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html#af6481a736dda88081db77b69beb4352f">createNthCond</a></div><div class="ttdeci">Value createNthCond(unsigned int idx, Value selector, OpBuilder &amp;rewriter)</div><div class="ttdef"><b>Definition</b> <a href="#l01194">Patterns.cpp:1194</a></div></div>
<div class="ttc" id="a_passes_2_convert_zhl_to_zml_2_patterns_8h_html"><div class="ttname"><a href="_passes_2_convert_zhl_to_zml_2_patterns_8h.html">Patterns.h</a></div></div>
<div class="ttc" id="a_type_binding_8h_html"><div class="ttname"><a href="_type_binding_8h.html">TypeBinding.h</a></div></div>
<div class="ttc" id="a_type_bindings_8h_html"><div class="ttname"><a href="_type_bindings_8h.html">TypeBindings.h</a></div></div>
<div class="ttc" id="a_types_8h_html"><div class="ttname"><a href="_types_8h.html">Types.h</a></div></div>
<div class="ttc" id="a_z_m_l_type_converter_8h_html"><div class="ttname"><a href="_z_m_l_type_converter_8h.html">ZMLTypeConverter.h</a></div></div>
<div class="ttc" id="aclasszhl_1_1_component_slot_html"><div class="ttname"><a href="classzhl_1_1_component_slot.html">zhl::ComponentSlot</a></div><div class="ttdef"><b>Definition</b> <a href="_component_slot_8h_source.html#l00022">ComponentSlot.h:22</a></div></div>
<div class="ttc" id="aclasszhl_1_1_type_binding_html"><div class="ttname"><a href="classzhl_1_1_type_binding.html">zhl::TypeBinding</a></div><div class="ttdoc">Binding to a ZIR type.</div><div class="ttdef"><b>Definition</b> <a href="_type_binding_8h_source.html#l00060">TypeBinding.h:60</a></div></div>
<div class="ttc" id="aclasszhl_1_1_type_binding_html_a20c511f4ffa7a629ee39f76ed416f19b"><div class="ttname"><a href="classzhl_1_1_type_binding.html#a20c511f4ffa7a629ee39f76ed416f19b">zhl::TypeBinding::getSlot</a></div><div class="ttdeci">FrameSlot * getSlot() const</div><div class="ttdoc">Returns the slot this type binding will use if it needs to define memory in the component.</div><div class="ttdef"><b>Definition</b> <a href="_type_binding_8h_source.html#l00302">TypeBinding.h:302</a></div></div>
<div class="ttc" id="aclasszhl_1_1_type_binding_html_a39c29134b4ce739f507542a6535de81b"><div class="ttname"><a href="classzhl_1_1_type_binding.html#a39c29134b4ce739f507542a6535de81b">zhl::TypeBinding::getName</a></div><div class="ttdeci">mlir::StringRef getName() const</div><div class="ttdoc">Returns the name of the type.</div><div class="ttdef"><b>Definition</b> <a href="_type_binding_8h_source.html#l00115">TypeBinding.h:115</a></div></div>
<div class="ttc" id="aclasszml_1_1_alloc_array_op_html"><div class="ttname"><a href="classzml_1_1_alloc_array_op.html">zml::AllocArrayOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l00322">Ops.h.inc:322</a></div></div>
<div class="ttc" id="aclasszml_1_1_assert_op_html"><div class="ttname"><a href="classzml_1_1_assert_op.html">zml::AssertOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l00417">Ops.h.inc:417</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html"><div class="ttname"><a href="classzml_1_1_component_builder.html">zml::ComponentBuilder</a></div><div class="ttdef"><b>Definition</b> <a href="_builder_8h_source.html#l00033">Builder.h:33</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a020c538361200cd26f7aef43b8c75fec"><div class="ttname"><a href="classzml_1_1_component_builder.html#a020c538361200cd26f7aef43b8c75fec">zml::ComponentBuilder::build</a></div><div class="ttdeci">ComponentOp build(mlir::OpBuilder &amp;builder)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00087">Builder.cpp:87</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a4bc5d93d94402a7987286ded0879570e"><div class="ttname"><a href="classzml_1_1_component_builder.html#a4bc5d93d94402a7987286ded0879570e">zml::ComponentBuilder::takeRegion</a></div><div class="ttdeci">ComponentBuilder &amp; takeRegion(mlir::Region *region)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00161">Builder.cpp:161</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a60fba3b494f1b54ceb6064ba59d27654"><div class="ttname"><a href="classzml_1_1_component_builder.html#a60fba3b494f1b54ceb6064ba59d27654">zml::ComponentBuilder::name</a></div><div class="ttdeci">ComponentBuilder &amp; name(mlir::StringRef name)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00135">Builder.cpp:135</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a826b89436fc7a0f473177fcd53439096"><div class="ttname"><a href="classzml_1_1_component_builder.html#a826b89436fc7a0f473177fcd53439096">zml::ComponentBuilder::location</a></div><div class="ttdeci">ComponentBuilder &amp; location(mlir::Location loc)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00140">Builder.cpp:140</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a8c45f614967cc4c2378d9722f7aa2fc2"><div class="ttname"><a href="classzml_1_1_component_builder.html#a8c45f614967cc4c2378d9722f7aa2fc2">zml::ComponentBuilder::constructor</a></div><div class="ttdeci">ComponentBuilder &amp; constructor(mlir::FunctionType constructorType, mlir::ArrayRef&lt; mlir::Location &gt; argLocs)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00145">Builder.cpp:145</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a9f7a15c8cb8421c02a70b9c3cc476939"><div class="ttname"><a href="classzml_1_1_component_builder.html#a9f7a15c8cb8421c02a70b9c3cc476939">zml::ComponentBuilder::typeParams</a></div><div class="ttdeci">ComponentBuilder &amp; typeParams(mlir::ArrayRef&lt; std::string &gt; params)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00109">Builder.cpp:109</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_a9fb3bcad8b4c9785b19950daa19e7207"><div class="ttname"><a href="classzml_1_1_component_builder.html#a9fb3bcad8b4c9785b19950daa19e7207">zml::ComponentBuilder::field</a></div><div class="ttdeci">ComponentBuilder &amp; field(mlir::StringRef name, mlir::Type type, mlir::Location loc, bool isColumn=false)</div></div>
<div class="ttc" id="aclasszml_1_1_component_builder_html_ac0d83ffa84f702bc30166621484d2a1e"><div class="ttname"><a href="classzml_1_1_component_builder.html#ac0d83ffa84f702bc30166621484d2a1e">zml::ComponentBuilder::attrs</a></div><div class="ttdeci">ComponentBuilder &amp; attrs(mlir::ArrayRef&lt; mlir::NamedAttribute &gt; attrs)</div><div class="ttdef"><b>Definition</b> <a href="_builder_8cpp_source.html#l00119">Builder.cpp:119</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_interface_html"><div class="ttname"><a href="classzml_1_1_component_interface.html">zml::ComponentInterface</a></div><div class="ttdef"><b>Definition</b> <a href="_op_interfaces_8h_8inc_source.html#l00361">OpInterfaces.h.inc:361</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_op_html"><div class="ttname"><a href="classzml_1_1_component_op.html">zml::ComponentOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l00707">Ops.h.inc:707</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_type_html_a02d908bf206f77032892b4767092e5ca"><div class="ttname"><a href="classzml_1_1_component_type.html#a02d908bf206f77032892b4767092e5ca">zml::ComponentType::Array</a></div><div class="ttdeci">static ComponentType Array(mlir::MLIRContext *ctx)</div><div class="ttdef"><b>Definition</b> <a href="_types_8h_8inc_source.html#l00070">Types.h.inc:70</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_type_html_a94ad0b38ddd8e7c46acc8d87c916e941"><div class="ttname"><a href="classzml_1_1_component_type.html#a94ad0b38ddd8e7c46acc8d87c916e941">zml::ComponentType::Val</a></div><div class="ttdeci">static ComponentType Val(mlir::MLIRContext *ctx)</div><div class="ttdef"><b>Definition</b> <a href="_types_8h_8inc_source.html#l00067">Types.h.inc:67</a></div></div>
<div class="ttc" id="aclasszml_1_1_component_type_html_ab7655cf701af8d634089ddea1a601a00"><div class="ttname"><a href="classzml_1_1_component_type.html#ab7655cf701af8d634089ddea1a601a00">zml::ComponentType::Component</a></div><div class="ttdeci">static ComponentType Component(mlir::MLIRContext *ctx)</div><div class="ttdef"><b>Definition</b> <a href="_types_8h_8inc_source.html#l00066">Types.h.inc:66</a></div></div>
<div class="ttc" id="aclasszml_1_1_constrain_op_html"><div class="ttname"><a href="classzml_1_1_constrain_op.html">zml::ConstrainOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l01028">Ops.h.inc:1028</a></div></div>
<div class="ttc" id="aclasszml_1_1_constructor_lowering_html"><div class="ttname"><a href="classzml_1_1_constructor_lowering.html">zml::ConstructorLowering</a></div><div class="ttdef"><b>Definition</b> <a href="_passes_2_convert_zhl_to_zml_2_patterns_8h_source.html#l00157">Patterns.h:157</a></div></div>
<div class="ttc" id="aclasszml_1_1_constructor_lowering_html_a12e08e5b2270152c09bc4ce01a6a3332"><div class="ttname"><a href="classzml_1_1_constructor_lowering.html#a12e08e5b2270152c09bc4ce01a6a3332">zml::ConstructorLowering::makeCtorCallBuilder</a></div><div class="ttdeci">mlir::FailureOr&lt; CtorCallBuilder &gt; makeCtorCallBuilder(mlir::Operation *, mlir::Value, mlir::OpBuilder &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="#l00174">Patterns.cpp:174</a></div></div>
<div class="ttc" id="aclasszml_1_1_constructor_lowering_html_a3ac9d909f498bfdab8c49a6229305762"><div class="ttname"><a href="classzml_1_1_constructor_lowering.html#a3ac9d909f498bfdab8c49a6229305762">zml::ConstructorLowering::prepareArgument</a></div><div class="ttdeci">mlir::Value prepareArgument(mlir::Value, mlir::Type, mlir::Location, mlir::ConversionPatternRewriter &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="#l00135">Patterns.cpp:135</a></div></div>
<div class="ttc" id="aclasszml_1_1_constructor_lowering_html_a5b91cc3f0249ccc1293e5f8f8f078e79"><div class="ttname"><a href="classzml_1_1_constructor_lowering.html#a5b91cc3f0249ccc1293e5f8f8f078e79">zml::ConstructorLowering::makeCtorCall</a></div><div class="ttdeci">mlir::LogicalResult makeCtorCall(Op, mlir::Value, mlir::ValueRange newArgs, mlir::ConversionPatternRewriter &amp;, GlobalBuilder::AndName globalBuilder=std::nullopt) const</div><div class="ttdef"><b>Definition</b> <a href="#l00185">Patterns.cpp:185</a></div></div>
<div class="ttc" id="aclasszml_1_1_constructor_lowering_html_ac9bdf8852d4fc16a7346c7a6a9d1a6c6"><div class="ttname"><a href="classzml_1_1_constructor_lowering.html#ac9bdf8852d4fc16a7346c7a6a9d1a6c6">zml::ConstructorLowering::prepareArguments</a></div><div class="ttdeci">void prepareArguments(mlir::ValueRange, mlir::ArrayRef&lt; mlir::Type &gt;, mlir::Location, mlir::ConversionPatternRewriter &amp;, std::vector&lt; mlir::Value &gt; &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="#l00098">Patterns.cpp:98</a></div></div>
<div class="ttc" id="aclasszml_1_1_ctor_call_builder_html_a4b782252f7287479e94cd5e8314945c5"><div class="ttname"><a href="classzml_1_1_ctor_call_builder.html#a4b782252f7287479e94cd5e8314945c5">zml::CtorCallBuilder::Make</a></div><div class="ttdeci">static mlir::FailureOr&lt; CtorCallBuilder &gt; Make(mlir::Operation *op, mlir::Value value, const zhl::ZIRTypeAnalysis &amp;typeAnalysis, mlir::OpBuilder &amp;builder, mlir::Value self, const zhl::TypeBindings &amp;bindings)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00287">Helpers.cpp:287</a></div></div>
<div class="ttc" id="aclasszml_1_1_extern_fn_ref_op_html"><div class="ttname"><a href="classzml_1_1_extern_fn_ref_op.html">zml::ExternFnRefOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l01867">Ops.h.inc:1867</a></div></div>
<div class="ttc" id="aclasszml_1_1_get_array_len_op_html"><div class="ttname"><a href="classzml_1_1_get_array_len_op.html">zml::GetArrayLenOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l02206">Ops.h.inc:2206</a></div></div>
<div class="ttc" id="aclasszml_1_1_get_global_op_html"><div class="ttname"><a href="classzml_1_1_get_global_op.html">zml::GetGlobalOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l02331">Ops.h.inc:2331</a></div></div>
<div class="ttc" id="aclasszml_1_1_global_builder_html_a56dc63c9a609448dfdd7a1236380e26a"><div class="ttname"><a href="classzml_1_1_global_builder.html#a56dc63c9a609448dfdd7a1236380e26a">zml::GlobalBuilder::buildDef</a></div><div class="ttdeci">void buildDef(mlir::Location loc, mlir::StringAttr flatName, mlir::Type type) const</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8h_source.html#l00093">Helpers.h:93</a></div></div>
<div class="ttc" id="aclasszml_1_1_global_builder_html_abb4f7d196b103cc649ce5ba1bcf02a08"><div class="ttname"><a href="classzml_1_1_global_builder.html#abb4f7d196b103cc649ce5ba1bcf02a08">zml::GlobalBuilder::AndName</a></div><div class="ttdeci">std::optional&lt; std::pair&lt; const GlobalBuilder *, mlir::StringAttr &gt; &gt; AndName</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8h_source.html#l00103">Helpers.h:103</a></div></div>
<div class="ttc" id="aclasszml_1_1_global_builder_html_af722e91ec191961b6712012fa219c4aa"><div class="ttname"><a href="classzml_1_1_global_builder.html#af722e91ec191961b6712012fa219c4aa">zml::GlobalBuilder::forName</a></div><div class="ttdeci">AndName forName(mlir::StringAttr nameOfGlobal) const</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8h_source.html#l00105">Helpers.h:105</a></div></div>
<div class="ttc" id="aclasszml_1_1_index_to_val_op_html"><div class="ttname"><a href="classzml_1_1_index_to_val_op.html">zml::IndexToValOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l02752">Ops.h.inc:2752</a></div></div>
<div class="ttc" id="aclasszml_1_1_lit_str_op_html"><div class="ttname"><a href="classzml_1_1_lit_str_op.html">zml::LitStrOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l03069">Ops.h.inc:3069</a></div></div>
<div class="ttc" id="aclasszml_1_1_lit_val_array_op_html"><div class="ttname"><a href="classzml_1_1_lit_val_array_op.html">zml::LitValArrayOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l03226">Ops.h.inc:3226</a></div></div>
<div class="ttc" id="aclasszml_1_1_lit_val_op_html"><div class="ttname"><a href="classzml_1_1_lit_val_op.html">zml::LitValOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l03384">Ops.h.inc:3384</a></div></div>
<div class="ttc" id="aclasszml_1_1_load_val_param_op_html"><div class="ttname"><a href="classzml_1_1_load_val_param_op.html">zml::LoadValParamOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l03542">Ops.h.inc:3542</a></div></div>
<div class="ttc" id="aclasszml_1_1_new_array_op_html"><div class="ttname"><a href="classzml_1_1_new_array_op.html">zml::NewArrayOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04080">Ops.h.inc:4080</a></div></div>
<div class="ttc" id="aclasszml_1_1_nop_op_html"><div class="ttname"><a href="classzml_1_1_nop_op.html">zml::NopOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04177">Ops.h.inc:4177</a></div></div>
<div class="ttc" id="aclasszml_1_1_read_array_op_html"><div class="ttname"><a href="classzml_1_1_read_array_op.html">zml::ReadArrayOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04280">Ops.h.inc:4280</a></div></div>
<div class="ttc" id="aclasszml_1_1_read_back_op_html"><div class="ttname"><a href="classzml_1_1_read_back_op.html">zml::ReadBackOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04419">Ops.h.inc:4419</a></div></div>
<div class="ttc" id="aclasszml_1_1_read_field_op_html"><div class="ttname"><a href="classzml_1_1_read_field_op.html">zml::ReadFieldOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04592">Ops.h.inc:4592</a></div></div>
<div class="ttc" id="aclasszml_1_1_self_op_html"><div class="ttname"><a href="classzml_1_1_self_op.html">zml::SelfOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l04726">Ops.h.inc:4726</a></div></div>
<div class="ttc" id="aclasszml_1_1_super_coerce_op_html"><div class="ttname"><a href="classzml_1_1_super_coerce_op.html">zml::SuperCoerceOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05392">Ops.h.inc:5392</a></div></div>
<div class="ttc" id="aclasszml_1_1_unifiable_cast_op_html"><div class="ttname"><a href="classzml_1_1_unifiable_cast_op.html">zml::UnifiableCastOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05490">Ops.h.inc:5490</a></div></div>
<div class="ttc" id="aclasszml_1_1_val_to_i1_op_html"><div class="ttname"><a href="classzml_1_1_val_to_i1_op.html">zml::ValToI1Op</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05588">Ops.h.inc:5588</a></div></div>
<div class="ttc" id="aclasszml_1_1_val_to_index_op_html"><div class="ttname"><a href="classzml_1_1_val_to_index_op.html">zml::ValToIndexOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05689">Ops.h.inc:5689</a></div></div>
<div class="ttc" id="aclasszml_1_1_var_args_op_html"><div class="ttname"><a href="classzml_1_1_var_args_op.html">zml::VarArgsOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05791">Ops.h.inc:5791</a></div></div>
<div class="ttc" id="aclasszml_1_1_write_array_op_html"><div class="ttname"><a href="classzml_1_1_write_array_op.html">zml::WriteArrayOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l05922">Ops.h.inc:5922</a></div></div>
<div class="ttc" id="aclasszml_1_1_write_field_op_html"><div class="ttname"><a href="classzml_1_1_write_field_op.html">zml::WriteFieldOp</a></div><div class="ttdef"><b>Definition</b> <a href="_ops_8h_8inc_source.html#l06092">Ops.h.inc:6092</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_array_lowering_html_a427797a08fa5acf2479f181e31f66ae9"><div class="ttname"><a href="classzml_1_1_zhl_array_lowering.html#a427797a08fa5acf2479f181e31f66ae9">zml::ZhlArrayLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ArrayOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlArrayLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00689">Patterns.cpp:689</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_back_lowering_html_a2534c7cb90ee44d0dc0016a1d2a81e8c"><div class="ttname"><a href="classzml_1_1_zhl_back_lowering.html#a2534c7cb90ee44d0dc0016a1d2a81e8c">zml::ZhlBackLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::BackOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01271">Patterns.cpp:1271</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_block_lowering_html_a01b2f5186fce126e3c79327a9afa66a2"><div class="ttname"><a href="classzml_1_1_zhl_block_lowering.html#a01b2f5186fce126e3c79327a9afa66a2">zml::ZhlBlockLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::BlockOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00921">Patterns.cpp:921</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_comp_to_zmir_comp_pattern_html_a1e561bf99880d9aafac856dca72be4ce"><div class="ttname"><a href="classzml_1_1_zhl_comp_to_zmir_comp_pattern.html#a1e561bf99880d9aafac856dca72be4ce">zml::ZhlCompToZmirCompPattern::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ComponentOp op, OpAdaptor adaptor, mlir::ConversionPatternRewriter &amp;rewriter) const override</div><div class="ttdoc">ZhlCompToZmirCompPattern.</div><div class="ttdef"><b>Definition</b> <a href="#l00735">Patterns.cpp:735</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_constrain_lowering_html_a8854ff472353d4c4ae2aa9b9980a25f7"><div class="ttname"><a href="classzml_1_1_zhl_constrain_lowering.html#a8854ff472353d4c4ae2aa9b9980a25f7">zml::ZhlConstrainLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ConstraintOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00306">Patterns.cpp:306</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_construct_global_lowering_html_a6bcf0ea7316a9faa47ea074347d93218"><div class="ttname"><a href="classzml_1_1_zhl_construct_global_lowering.html#a6bcf0ea7316a9faa47ea074347d93218">zml::ZhlConstructGlobalLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ConstructGlobalOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01303">Patterns.cpp:1303</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_declaration_removal_html_a0a3a4ab658621b46e9f53607d0ee6287"><div class="ttname"><a href="classzml_1_1_zhl_declaration_removal.html#a0a3a4ab658621b46e9f53607d0ee6287">zml::ZhlDeclarationRemoval::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::DeclarationOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlDeclarationRemoval.</div><div class="ttdef"><b>Definition</b> <a href="#l00398">Patterns.cpp:398</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_define_lowering_html_a5e5c2c0891a6d8104a511beade835c6f"><div class="ttname"><a href="classzml_1_1_zhl_define_lowering.html#a5e5c2c0891a6d8104a511beade835c6f">zml::ZhlDefineLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::DefinitionOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlDefinitionLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00411">Patterns.cpp:411</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_directive_removal_html_a5f8683fc81efdac6910ea25d8b245ffe"><div class="ttname"><a href="classzml_1_1_zhl_directive_removal.html#a5f8683fc81efdac6910ea25d8b245ffe">zml::ZhlDirectiveRemoval::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::DirectiveOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00348">Patterns.cpp:348</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_extern_lowering_html_a0160889e694c94557f96e42f94b21a2a"><div class="ttname"><a href="classzml_1_1_zhl_extern_lowering.html#a0160889e694c94557f96e42f94b21a2a">zml::ZhlExternLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ExternOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00513">Patterns.cpp:513</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_generic_removal_html_a3f620c84dcc91faf4892778f01d05a11"><div class="ttname"><a href="classzml_1_1_zhl_generic_removal.html#a3f620c84dcc91faf4892778f01d05a11">zml::ZhlGenericRemoval::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::TypeParamOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlGenericRemoval.</div><div class="ttdef"><b>Definition</b> <a href="#l00359">Patterns.cpp:359</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_get_global_lowering_html_aca5dbb53afc791608db27b907e48c413"><div class="ttname"><a href="classzml_1_1_zhl_get_global_lowering.html#aca5dbb53afc791608db27b907e48c413">zml::ZhlGetGlobalLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::GetGlobalOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01311">Patterns.cpp:1311</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_global_removal_html_a0336adfaa93b8534b0617b9f9e451044"><div class="ttname"><a href="classzml_1_1_zhl_global_removal.html#a0336adfaa93b8534b0617b9f9e451044">zml::ZhlGlobalRemoval::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::GlobalOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlGlobalRemoval.</div><div class="ttdef"><b>Definition</b> <a href="#l00335">Patterns.cpp:335</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_literal_lowering_html_a3e147e2bcb3a8f4f2422ff3f72786cae"><div class="ttname"><a href="classzml_1_1_zhl_literal_lowering.html#a3e147e2bcb3a8f4f2422ff3f72786cae">zml::ZhlLiteralLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::LiteralOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlLiteralLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00229">Patterns.cpp:229</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_literal_str_lowering_html_a2041197557ae96ad5ac5a42198ea724a"><div class="ttname"><a href="classzml_1_1_zhl_literal_str_lowering.html#a2041197557ae96ad5ac5a42198ea724a">zml::ZhlLiteralStrLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::StringOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlLiteralStrLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00246">Patterns.cpp:246</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_lookup_lowering_html_af0abe1b1620e7cbb122b2dc31b581ad2"><div class="ttname"><a href="classzml_1_1_zhl_lookup_lowering.html#af0abe1b1620e7cbb122b2dc31b581ad2">zml::ZhlLookupLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::LookupOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlLookupLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00572">Patterns.cpp:572</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_map_lowering_html_a4bced19fe3b8f5e2e2479eeb6185cf5e"><div class="ttname"><a href="classzml_1_1_zhl_map_lowering.html#a4bced19fe3b8f5e2e2479eeb6185cf5e">zml::ZhlMapLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::MapOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlMapOpLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00849">Patterns.cpp:849</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_op_lowering_pattern_html_a205a01d942c2e44a110b940433324a39"><div class="ttname"><a href="classzml_1_1_zhl_op_lowering_pattern.html#a205a01d942c2e44a110b940433324a39">zml::ZhlOpLoweringPattern&lt; zirgen::Zhl::ConstraintOp &gt;::getCastedValue</a></div><div class="ttdeci">mlir::FailureOr&lt; mlir::Value &gt; getCastedValue(mlir::Operation *op, mlir::OpBuilder &amp;builder, mlir::SmallVector&lt; mlir::Operation *, 2 &gt; &amp;generatedOps, mlir::Type super=nullptr) const</div><div class="ttdef"><b>Definition</b> <a href="_passes_2_convert_zhl_to_zml_2_patterns_8h_source.html#l00069">Patterns.h:69</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_op_lowering_pattern_html_a49a09b8c68b8526db04e3cd4845163cb"><div class="ttname"><a href="classzml_1_1_zhl_op_lowering_pattern.html#a49a09b8c68b8526db04e3cd4845163cb">zml::ZhlOpLoweringPattern&lt; zirgen::Zhl::ComponentOp &gt;::getTypeBindings</a></div><div class="ttdeci">const zhl::TypeBindings &amp; getTypeBindings() const</div><div class="ttdef"><b>Definition</b> <a href="_passes_2_convert_zhl_to_zml_2_patterns_8h_source.html#l00151">Patterns.h:151</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_op_lowering_pattern_html_ad4a3b22232374806ab988275dd0a355b"><div class="ttname"><a href="classzml_1_1_zhl_op_lowering_pattern.html#ad4a3b22232374806ab988275dd0a355b">zml::ZhlOpLoweringPattern::typeAnalysis</a></div><div class="ttdeci">zhl::ZIRTypeAnalysis *const typeAnalysis</div><div class="ttdef"><b>Definition</b> <a href="_passes_2_convert_zhl_to_zml_2_patterns_8h_source.html#l00154">Patterns.h:154</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_op_lowering_pattern_html_ae51d047fee6a460bb3623e50813c83bd"><div class="ttname"><a href="classzml_1_1_zhl_op_lowering_pattern.html#ae51d047fee6a460bb3623e50813c83bd">zml::ZhlOpLoweringPattern&lt; zirgen::Zhl::LiteralOp &gt;::getType</a></div><div class="ttdeci">mlir::FailureOr&lt; zhl::TypeBinding &gt; getType(mlir::Operation *op) const</div><div class="ttdef"><b>Definition</b> <a href="_passes_2_convert_zhl_to_zml_2_patterns_8h_source.html#l00038">Patterns.h:38</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_parameter_lowering_html_a81f4a43d268e2a7c7cca7a33e72b955e"><div class="ttname"><a href="classzml_1_1_zhl_parameter_lowering.html#a81f4a43d268e2a7c7cca7a33e72b955e">zml::ZhlParameterLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ConstructorParamOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlParameterLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00262">Patterns.cpp:262</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_range_op_lowering_html_a7818eb7b9b67048477205792276c2dd6"><div class="ttname"><a href="classzml_1_1_zhl_range_op_lowering.html#a7818eb7b9b67048477205792276c2dd6">zml::ZhlRangeOpLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::RangeOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlRangeOpLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00780">Patterns.cpp:780</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_reduce_lowering_html_aa1d25dc8251e9d8790bc501357288241"><div class="ttname"><a href="classzml_1_1_zhl_reduce_lowering.html#aa1d25dc8251e9d8790bc501357288241">zml::ZhlReduceLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::ReduceOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01146">Patterns.cpp:1146</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_specialize_removal_html_abc6c0894af054aa2c42783c34469d2f2"><div class="ttname"><a href="classzml_1_1_zhl_specialize_removal.html#abc6c0894af054aa2c42783c34469d2f2">zml::ZhlSpecializeRemoval::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SpecializeOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlSpecializeRemoval.</div><div class="ttdef"><b>Definition</b> <a href="#l00381">Patterns.cpp:381</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_subscript_lowering_html_a37eaa532c3b8baff7607542ef559c616"><div class="ttname"><a href="classzml_1_1_zhl_subscript_lowering.html#a37eaa532c3b8baff7607542ef559c616">zml::ZhlSubscriptLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SubscriptOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlSubscriptLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00652">Patterns.cpp:652</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_super_lowering_in_block_html_a3596751eebc43993717960d7971e0b4b"><div class="ttname"><a href="classzml_1_1_zhl_super_lowering_in_block.html#a3596751eebc43993717960d7971e0b4b">zml::ZhlSuperLoweringInBlock::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SuperOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00964">Patterns.cpp:964</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_super_lowering_in_func_html_a9781968a1e31743df8627f82824be112"><div class="ttname"><a href="classzml_1_1_zhl_super_lowering_in_func.html#a9781968a1e31743df8627f82824be112">zml::ZhlSuperLoweringInFunc::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SuperOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdoc">ZhlSuperLowering.</div><div class="ttdef"><b>Definition</b> <a href="#l00466">Patterns.cpp:466</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_super_lowering_in_map_html_a94e3406aafb86cdee66528c7b9f35310"><div class="ttname"><a href="classzml_1_1_zhl_super_lowering_in_map.html#a94e3406aafb86cdee66528c7b9f35310">zml::ZhlSuperLoweringInMap::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SuperOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l00937">Patterns.cpp:937</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_super_lowering_in_switch_html_a2bd9b972eeefd01e2195af932048955d"><div class="ttname"><a href="classzml_1_1_zhl_super_lowering_in_switch.html#a2bd9b972eeefd01e2195af932048955d">zml::ZhlSuperLoweringInSwitch::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SuperOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01005">Patterns.cpp:1005</a></div></div>
<div class="ttc" id="aclasszml_1_1_zhl_switch_lowering_html_a2ba4008057e887df5016da6f6e8713c2"><div class="ttname"><a href="classzml_1_1_zhl_switch_lowering.html#a2ba4008057e887df5016da6f6e8713c2">zml::ZhlSwitchLowering::matchAndRewrite</a></div><div class="ttdeci">mlir::LogicalResult matchAndRewrite(zirgen::Zhl::SwitchOp, OpAdaptor, mlir::ConversionPatternRewriter &amp;) const override</div><div class="ttdef"><b>Definition</b> <a href="#l01238">Patterns.cpp:1238</a></div></div>
<div class="ttc" id="anamespacemlir_html"><div class="ttname"><a href="namespacemlir.html">mlir</a></div><div class="ttdef"><b>Definition</b> <a href="_types_8h_8inc_source.html#l00013">Types.h.inc:13</a></div></div>
<div class="ttc" id="anamespacezhl_html"><div class="ttname"><a href="namespacezhl.html">zhl</a></div><div class="ttdef"><b>Definition</b> <a href="_analysis_8cpp_source.html#l00023">Analysis.cpp:23</a></div></div>
<div class="ttc" id="anamespacezml_html"><div class="ttname"><a href="namespacezml.html">zml</a></div><div class="ttdef"><b>Definition</b> <a href="_baby_bear_8cpp_source.html#l00020">BabyBear.cpp:20</a></div></div>
<div class="ttc" id="anamespacezml_html_a2c7bc88a4b1edd7bcf72f95434826150"><div class="ttname"><a href="namespacezml.html#a2c7bc88a4b1edd7bcf72f95434826150">zml::materializeTypeBinding</a></div><div class="ttdeci">mlir::Type materializeTypeBinding(mlir::MLIRContext *, const zhl::TypeBinding &amp;)</div></div>
<div class="ttc" id="anamespacezml_html_a3bae9dacc6b7b762216f2f107a48bdb7"><div class="ttname"><a href="namespacezml.html#a3bae9dacc6b7b762216f2f107a48bdb7">zml::materializeTypeBindingConstructor</a></div><div class="ttdeci">mlir::FunctionType materializeTypeBindingConstructor(mlir::OpBuilder &amp;, const zhl::TypeBinding &amp;, const zhl::TypeBindings &amp;)</div></div>
<div class="ttc" id="anamespacezml_html_ab50cb91affe3de64b07a2bbd6c18e45e"><div class="ttname"><a href="namespacezml.html#ab50cb91affe3de64b07a2bbd6c18e45e">zml::constructPODComponent</a></div><div class="ttdeci">FailureOr&lt; Value &gt; constructPODComponent(Operation *op, zhl::TypeBinding &amp;binding, OpBuilder &amp;builder, Value self, llvm::function_ref&lt; mlir::Value()&gt; superTypeValueCb, const zhl::TypeBindings &amp;bindings)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00207">Helpers.cpp:207</a></div></div>
<div class="ttc" id="anamespacezml_html_ab754e6906cb92a1b96b2813c7014813c"><div class="ttname"><a href="namespacezml.html#ab754e6906cb92a1b96b2813c7014813c">zml::getType</a></div><div class="ttdeci">mlir::Type getType(CompOp &amp;op)</div><div class="ttdef"><b>Definition</b> <a href="_ops_8cpp_source.html#l00184">Ops.cpp:184</a></div></div>
<div class="ttc" id="anamespacezml_html_ac77c76297c90961806f887bcec9d1992"><div class="ttname"><a href="namespacezml.html#ac77c76297c90961806f887bcec9d1992">zml::coerceToArray</a></div><div class="ttdeci">mlir::FailureOr&lt; Value &gt; coerceToArray(TypedValue&lt; ComponentType &gt; v, OpBuilder &amp;builder)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00363">Helpers.cpp:363</a></div></div>
<div class="ttc" id="anamespacezml_html_ac909911d5ab140af73258b71963d2328"><div class="ttname"><a href="namespacezml.html#ac909911d5ab140af73258b71963d2328">zml::storeSlot</a></div><div class="ttdeci">void storeSlot(ComponentSlot &amp;slot, Value value, FlatSymbolRefAttr slotName, Type slotType, Location loc, OpBuilder &amp;builder, Value self)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00127">Helpers.cpp:127</a></div></div>
<div class="ttc" id="anamespacezml_html_acd1fe036d69906f5ce404618887ba966"><div class="ttname"><a href="namespacezml.html#acd1fe036d69906f5ce404618887ba966">zml::storeAndLoadSlot</a></div><div class="ttdeci">Value storeAndLoadSlot(ComponentSlot &amp;slot, Value value, FlatSymbolRefAttr slotName, Type slotType, Location loc, OpBuilder &amp;builder, Value self)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00100">Helpers.cpp:100</a></div></div>
<div class="ttc" id="anamespacezml_html_af59c2deb15e027bf93c75fdb6172d390"><div class="ttname"><a href="namespacezml.html#af59c2deb15e027bf93c75fdb6172d390">zml::createSlot</a></div><div class="ttdeci">FlatSymbolRefAttr createSlot(zhl::ComponentSlot *slot, OpBuilder &amp;builder, ComponentInterface component, Location loc)</div><div class="ttdef"><b>Definition</b> <a href="_helpers_8cpp_source.html#l00064">Helpers.cpp:64</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.13.2-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_2766abe8936b29a3963817f5e95804c9.html">Passes</a></li><li class="navelem"><a class="el" href="dir_5b1ae49bb33a16519da63de38417b2f1.html">ConvertZhlToZml</a></li><li class="navelem"><a class="el" href="_passes_2_convert_zhl_to_zml_2_patterns_8cpp.html">Patterns.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
    <li class="footer">Copyright 2025 Veridise Inc. under the Apache License v2.0.</li>
  </ul>
</div>
</body>
</html>
